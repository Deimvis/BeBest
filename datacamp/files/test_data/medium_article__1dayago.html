<!doctype html><html lang="en"><head><title data-rh="true">Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions | by Samet Karadag | Google Cloud - Community | Oct, 2023 | Medium</title><meta data-rh="true" charset="utf-8"/><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1,maximum-scale=1"/><meta data-rh="true" name="theme-color" content="#000000"/><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"/><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"/><meta data-rh="true" property="al:ios:app_name" content="Medium"/><meta data-rh="true" property="al:ios:app_store_id" content="828256236"/><meta data-rh="true" property="al:android:package" content="com.medium.reader"/><meta data-rh="true" property="fb:app_id" content="542599432471018"/><meta data-rh="true" property="og:site_name" content="Medium"/><meta data-rh="true" property="og:type" content="article"/><meta data-rh="true" property="article:published_time" content="2023-10-13T11:29:47.564Z"/><meta data-rh="true" name="title" content="Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions | by Samet Karadag | Google Cloud - Community | Oct, 2023 | Medium"/><meta data-rh="true" property="og:title" content="Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions"/><meta data-rh="true" property="al:android:url" content="medium://p/fc8fbbd5f5de"/><meta data-rh="true" property="al:ios:url" content="medium://p/fc8fbbd5f5de"/><meta data-rh="true" property="al:android:app_name" content="Medium"/><meta data-rh="true" name="description" content="In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and curates it based on where it came from. We’ll use Cloud Workflows…"/><meta data-rh="true" property="og:description" content="In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and…"/><meta data-rh="true" property="og:url" content="https://medium.com/google-cloud/building-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de"/><meta data-rh="true" property="al:web:url" content="https://medium.com/google-cloud/building-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de"/><meta data-rh="true" property="og:image" content="https://miro.medium.com/v2/resize:fit:462/1*MbjpDYnhlwdiTkkNQcq2wA.png"/><meta data-rh="true" property="article:author" content="https://sametkaradag.medium.com"/><meta data-rh="true" name="author" content="Samet Karadag"/><meta data-rh="true" name="robots" content="index,follow,max-image-preview:large"/><meta data-rh="true" name="referrer" content="unsafe-url"/><meta data-rh="true" property="twitter:title" content="Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions"/><meta data-rh="true" name="twitter:site" content="@googlecloudtech"/><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/fc8fbbd5f5de"/><meta data-rh="true" property="twitter:description" content="In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and…"/><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/v2/resize:fit:462/1*MbjpDYnhlwdiTkkNQcq2wA.png"/><meta data-rh="true" name="twitter:card" content="summary_large_image"/><meta data-rh="true" name="twitter:creator" content="@samkaradag"/><meta data-rh="true" name="twitter:label1" content="Reading time"/><meta data-rh="true" name="twitter:data1" content="5 min read"/><meta data-rh="true" name="twitter:tile:template:testing" content="2"/><meta data-rh="true" name="twitter:tile:image" content="https://miro.medium.com/v2/resize:fit:462/1*MbjpDYnhlwdiTkkNQcq2wA.png"/><meta data-rh="true" name="twitter:tile:info1:icon" content="Person"/><meta data-rh="true" name="twitter:tile:info1:text" content="Samet Karadag"/><meta data-rh="true" name="twitter:tile:info2:icon" content="Calendar"/><meta data-rh="true" name="twitter:tile:info2:text" content="Oct 13, 2023"/><meta data-rh="true" name="twitter:cta" content="Read on Medium"/><link data-rh="true" rel="icon" href="https://miro.medium.com/v2/1*m-R_BkNf1Qjr1YbyOIJY2w.png"/><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="/osd.xml"/><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://miro.medium.com/v2/resize:fill:152:152/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://miro.medium.com/v2/resize:fill:120:120/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://miro.medium.com/v2/resize:fill:76:76/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://miro.medium.com/v2/resize:fill:60:60/1*sHhtYhaCe2Uc3IU0IgKwIQ.png"/><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/Medium-Avatar-500x500.svg" color="#171717"/><link data-rh="true" rel="preconnect" href="https://glyph.medium.com" crossOrigin=""/><link data-rh="true" id="glyph_preload_link" rel="preload" as="style" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="https://glyph.medium.com/css/unbound.css"/><link data-rh="true" rel="author" href="https://sametkaradag.medium.com"/><link data-rh="true" rel="canonical" href="https://medium.com/google-cloud/building-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de"/><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/fc8fbbd5f5de"/><script data-rh="true" type="application/ld+json">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:1200\u002F1*MbjpDYnhlwdiTkkNQcq2wA.png"],"url":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de","dateCreated":"2023-10-13T10:36:51.286Z","datePublished":"2023-10-13T10:36:51.286Z","dateModified":"2023-10-14T07:37:20.272Z","headline":"Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions","name":"Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions","description":"In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and curates it based on where it came from. We’ll use Cloud Workflows…","identifier":"fc8fbbd5f5de","author":{"@type":"Person","name":"Samet Karadag","url":"https:\u002F\u002Fsametkaradag.medium.com"},"creator":["Samet Karadag"],"publisher":{"@type":"Organization","name":"Google Cloud - Community","url":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud","logo":{"@type":"ImageObject","width":60,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fv2\u002Fresize:fit:120\u002F1*FUjLiCANvATKeaJEeg20Rw.png"}},"mainEntityOfPage":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de"}</script><style type="text/css" data-fela-rehydration="664" data-fela-type="STATIC">html{box-sizing:border-box;-webkit-text-size-adjust:100%}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}:root{--reach-tabs:1;--reach-menu-button:1}#speechify-root{font-family:Sohne, sans-serif}div[data-popper-reference-hidden="true"]{visibility:hidden;pointer-events:none}
/*XCode style (c) Angel Garcia <angelgarcia.mail@gmail.com>*/.hljs {background: #fff;color: black;
}/* Gray DOCTYPE selectors like WebKit */
.xml .hljs-meta {color: #c0c0c0;
}.hljs-comment,
.hljs-quote {color: #007400;
}.hljs-tag,
.hljs-attribute,
.hljs-keyword,
.hljs-selector-tag,
.hljs-literal,
.hljs-name {color: #aa0d91;
}.hljs-variable,
.hljs-template-variable {color: #3F6E74;
}.hljs-code,
.hljs-string,
.hljs-meta .hljs-string {color: #c41a16;
}.hljs-regexp,
.hljs-link {color: #0E0EFF;
}.hljs-title,
.hljs-symbol,
.hljs-bullet,
.hljs-number {color: #1c00cf;
}.hljs-section,
.hljs-meta {color: #643820;
}.hljs-title.class_,
.hljs-class .hljs-title,
.hljs-type,
.hljs-built_in,
.hljs-params {color: #5c2699;
}.hljs-attr {color: #836C28;
}.hljs-subst {color: #000;
}.hljs-formula {background-color: #eee;font-style: italic;
}.hljs-addition {background-color: #baeeba;
}.hljs-deletion {background-color: #ffc8bd;
}.hljs-selector-id,
.hljs-selector-class {color: #9b703f;
}.hljs-doctag,
.hljs-strong {font-weight: bold;
}.hljs-emphasis {font-style: italic;
}
</style><style type="text/css" data-fela-rehydration="664" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-moz-keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@keyframes k1{0%{opacity:0.8}50%{opacity:0.5}100%{opacity:0.8}}@-webkit-keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k2{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{display:block}.m{position:sticky}.n{top:0}.o{z-index:500}.p{padding:0 24px}.q{align-items:center}.r{border-bottom:solid 1px #F2F2F2}.y{height:41px}.z{line-height:20px}.ab{display:flex}.ac{height:57px}.ae{flex:1 0 auto}.af{color:inherit}.ag{fill:inherit}.ah{font-size:inherit}.ai{border:inherit}.aj{font-family:inherit}.ak{letter-spacing:inherit}.al{font-weight:inherit}.am{padding:0}.an{margin:0}.ao{cursor:pointer}.ap:disabled{cursor:not-allowed}.aq:disabled{color:#6B6B6B}.ar:disabled{fill:#6B6B6B}.au{fill:rgba(0, 0, 0, 1)}.av{height:22px}.aw{margin-left:16px}.ax{border:none}.ay{border-radius:20px}.az{width:240px}.ba{background:#F9F9F9}.bb path{fill:#6B6B6B}.bd{outline:none}.be{font-family:sohne, "Helvetica Neue", Helvetica, Arial, sans-serif}.bf{font-size:14px}.bg{width:100%}.bh{padding:10px 20px 10px 0}.bi{background-color:transparent}.bj{color:#242424}.bk::placeholder{color:#6B6B6B}.bl{display:inline-block}.bm{margin-left:12px}.bn{margin-right:12px}.bo{border-radius:4px}.bp{margin-left:24px}.bq{height:24px}.bw{background-color:#F9F9F9}.bx{border-radius:50%}.by{height:32px}.bz{width:32px}.ca{justify-content:center}.cg{max-width:680px}.ch{min-width:0}.ci{animation:k1 1.2s ease-in-out infinite}.cj{height:100vh}.ck{margin-bottom:16px}.cl{margin-top:48px}.cm{align-items:flex-start}.cn{flex-direction:column}.co{justify-content:space-between}.cp{margin-bottom:24px}.cv{width:80%}.cw{background-color:#F2F2F2}.dc{height:44px}.dd{width:44px}.de{margin:auto 0}.df{margin-bottom:4px}.dg{height:16px}.dh{width:120px}.di{width:80px}.do{margin-bottom:8px}.dp{width:96%}.dq{width:98%}.dr{width:81%}.dx{margin:0 24px}.eb{background:rgba(255, 255, 255, 1)}.ec{box-sizing:border-box}.ed{border:1px solid #F2F2F2}.ee{box-shadow:0 1px 4px #F2F2F2}.ef{max-height:100vh}.eg{overflow-y:auto}.eh{position:absolute}.ei{left:0}.ej{top:calc(100vh + 100px)}.ek{bottom:calc(100vh + 100px)}.el{width:10px}.em{pointer-events:none}.eo{word-break:break-word}.ep{word-wrap:break-word}.eq:after{display:block}.er:after{content:""}.es:after{clear:both}.et{line-height:1.23}.eu{letter-spacing:0}.ev{font-style:normal}.ew{font-weight:700}.fw{@media all and (max-width: 551.98px):8px}.fx{@media all and (min-width: 552px) and (max-width: 727.98px):8px}.fy{@media all and (min-width: 728px) and (max-width: 903.98px):16px}.fz{@media all and (min-width: 904px) and (max-width: 1079.98px):16px}.ga{@media all and (min-width: 1080px):16px}.gg{align-items:baseline}.gh{width:48px}.gi{height:48px}.gj{border:2px solid rgba(255, 255, 255, 1)}.gk{z-index:0}.gl{box-shadow:none}.gm{border:1px solid rgba(0, 0, 0, 0.05)}.go{position:relative}.gp{margin-left:-12px}.gq{width:28px}.gr{height:28px}.gs{z-index:1}.gt{width:24px}.gu{margin-bottom:2px}.gv{flex-wrap:nowrap}.gw{font-size:16px}.gx{line-height:24px}.gz{margin:0 8px}.ha{display:inline}.hb{color:#6B6B6B}.hc{color:rgba(26, 137, 23, 1)}.hd{fill:rgba(26, 137, 23, 1)}.he:disabled{opacity:0.3}.hh{flex:0 0 auto}.hk{flex-wrap:wrap}.hn{white-space:pre-wrap}.ho{margin-right:4px}.hp{overflow:hidden}.hq{max-height:20px}.hr{text-overflow:ellipsis}.hs{display:-webkit-box}.ht{-webkit-line-clamp:1}.hu{-webkit-box-orient:vertical}.hv{word-break:break-all}.hx{padding-left:8px}.hy{padding-right:8px}.iz> *{flex-shrink:0}.ja{overflow-x:scroll}.jb::-webkit-scrollbar{display:none}.jc{scrollbar-width:none}.jd{-ms-overflow-style:none}.jg{width:74px}.jh{flex-direction:row}.jk{-webkit-user-select:none}.jl{border:0}.jm{cursor:progress}.jn{fill:rgba(117, 117, 117, 1)}.jq{opacity:0.25}.jr{outline:0}.js{user-select:none}.jt> svg{pointer-events:none}.kc{font-size:13px}.kd{opacity:1}.ke{padding:4px 0}.kf{fill:#6B6B6B}.ki{margin-top:0px}.kj{width:16px}.kk{padding:8px 2px}.kl svg{color:#6B6B6B}.lc{line-height:1.58}.ld{letter-spacing:-0.004em}.le{font-family:source-serif-pro, Georgia, Cambria, "Times New Roman", Times, serif}.lz{margin-bottom:-0.46em}.ma{line-height:1.12}.mb{letter-spacing:-0.022em}.mc{font-weight:600}.mx{margin-bottom:-0.28em}.nd{text-decoration:underline}.nj{overflow-x:auto}.nk{font-family:source-code-pro, Menlo, Monaco, "Courier New", Courier, monospace}.nl{padding:32px}.nm{border:1px solid #E5E5E5}.nn{line-height:1.4}.no{margin-top:-0.2em}.np{margin-bottom:-0.2em}.nq{white-space:pre}.nr{min-width:fit-content}.ns{margin-left:auto}.nt{margin-right:auto}.nu{max-width:462px}.nv{clear:both}.nw{max-width:100%}.nx{height:auto}.ny{max-width:436px}.nz{max-width:880px}.ob{cursor:zoom-in}.oc{z-index:auto}.oe{margin-top:10px}.of{text-align:center}.og{max-width:728px}.oj{margin-bottom:26px}.ok{margin-top:6px}.ol{margin-top:8px}.om{margin-right:8px}.on{padding:8px 16px}.oo{border-radius:100px}.op{transition:background 300ms ease}.or{white-space:nowrap}.os{border-top:none}.oy{height:52px}.oz{max-height:52px}.pa{box-sizing:content-box}.pb{position:static}.pd{max-width:155px}.pj{margin-right:20px}.pp{align-items:flex-end}.pq{width:76px}.pr{height:76px}.ps{border:2px solid #F9F9F9}.pt{height:72px}.pu{width:72px}.pv{margin-left:-16px}.pw{width:36px}.px{height:36px}.py{color:rgba(255, 255, 255, 1)}.pz{fill:rgba(255, 255, 255, 1)}.qa{background:rgba(25, 25, 25, 1)}.qb{border-color:rgba(25, 25, 25, 1)}.qf:disabled{cursor:inherit !important}.qg:disabled{opacity:0.1}.qh:disabled:hover{background:rgba(25, 25, 25, 1)}.qi:disabled:hover{border-color:rgba(25, 25, 25, 1)}.qj{border-radius:99em}.qk{width:auto}.ql{border-width:1px}.qm{border-style:solid}.qn{text-decoration:none}.qo{margin-left:8px}.qp{stroke:#F2F2F2}.qq{color:#F2F2F2}.qr{fill:#F2F2F2}.qs{background:#F2F2F2}.qt{border-color:#F2F2F2}.qz{font-weight:500}.ra{font-size:24px}.rb{line-height:30px}.rc{letter-spacing:-0.016em}.rd{margin-top:16px}.re{height:0px}.rf{border-bottom:solid 1px #E5E5E5}.rl{margin-top:72px}.rm{padding:24px 0}.rn{margin-bottom:0px}.ro{margin-right:16px}.rp{display:inline-flex}.rv{margin-bottom:32px}.rw{margin-top:40px}.rx{align-items:stretch}.th{flex-grow:0}.tn{height:100%}.to{display:grid}.tp{grid-template-columns:repeat(12, 1fr)}.tq{grid-template-rows:auto 1fr}.ub{grid-area:image}.uc{grid-area:content}.ui{border-radius:2px}.uj{aspect-ratio:2}.uk{object-fit:cover}.ul{object-position:50% 50%}.ur{box-shadow:inset 0 0 0 1px rgba(0, 0, 0, 0.05)}.us{height:20px}.ut{width:20px}.uu{padding-right:4px}.vv{padding-top:8px}.vw{max-height:40px}.vx{-webkit-line-clamp:2}.wn{margin-left:20px}.wo{margin-left:4px}.wp{justify-content:flex-end}.wq{flex:0 0 0}.wr{margin-top:32px}.wy{fill:#242424}.wz{background:0}.xa{border-color:#242424}.xc:disabled:hover{color:#242424}.xd:disabled:hover{fill:#242424}.xe:disabled:hover{border-color:#242424}.xy{padding-bottom:40px}.xz{padding-top:88px}.ya{margin-bottom:40px}.yb{margin-top:4px}.yc{border-right:3px solid #F9F9F9}.yd{z-index:3}.ye{z-index:2}.yf{margin-left:-24px}.yg{margin-left:-36px}.yh{border-radius:0 3px 3px 0}.yi{width:93px}.as:hover:not(:disabled){color:rgba(25, 25, 25, 1)}.at:hover:not(:disabled){fill:rgba(25, 25, 25, 1)}.gn:hover{background-color:rgba(0, 0, 0, 0.1)}.gy:hover{text-decoration:underline}.hf:hover:not(:disabled){color:rgba(15, 115, 12, 1)}.hg:hover:not(:disabled){fill:rgba(15, 115, 12, 1)}.jp:hover{fill:rgba(117, 117, 117, 1)}.kg:hover{fill:#000000}.kh:hover p{color:#000000}.km:hover svg{color:#000000}.oq:hover{background-color:#F2F2F2}.qc:hover{background:#000000}.qd:hover{border-color:#242424}.qe:hover{cursor:pointer}.qu:hover{background:#F2F2F2}.qv:hover{border-color:#F2F2F2}.qw:hover{cursor:wait}.qx:hover{color:#F2F2F2}.qy:hover{fill:#F2F2F2}.xb:hover{color:#000000}.bc:focus-within path{fill:#242424}.jo:focus{fill:rgba(117, 117, 117, 1)}.kn:focus svg{color:#000000}.od:focus{transform:scale(1.01)}.ju:active{border-style:none}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.bv{width:64px}.cf{margin:0 64px}.cu{height:48px}.db{margin-bottom:52px}.dn{margin-bottom:48px}.dw{margin-bottom:68px}.ea{max-width:680px}.fr{font-size:42px}.fs{margin-top:1.19em}.ft{margin-bottom:32px}.fu{line-height:52px}.fv{letter-spacing:-0.011em}.gf{align-items:center}.il{border-top:solid 1px #F2F2F2}.im{border-bottom:solid 1px #F2F2F2}.in{margin:32px 0 0}.io{padding:3px 8px}.ix> *{margin-right:24px}.iy> :last-child{margin-right:0}.jf{display:flex}.kb{margin-top:0px}.lv{font-size:20px}.lw{margin-top:2em}.lx{line-height:32px}.ly{letter-spacing:-0.003em}.mt{font-size:24px}.mu{margin-top:1.95em}.mv{line-height:30px}.mw{letter-spacing:-0.016em}.nc{margin-top:0.86em}.ni{margin-top:56px}.ox{margin-bottom:88px}.pi{display:inline-block}.po{padding-top:72px}.rk{margin-top:40px}.ru{margin:0}.sk{width:calc(100% + 32px)}.sl{margin-left:-16px}.sm{margin-right:-16px}.td{padding-left:16px}.te{padding-right:16px}.tf{flex-basis:50%}.tg{max-width:50%}.tm{padding-bottom:56px}.tz{gap:24px 0}.ua{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uh{display:block}.uq{margin-bottom:16px}.vd{padding-bottom:16px}.ve{flex:1 0 auto}.vr{line-height:24px}.vs{max-height:48px}.vt{-webkit-line-clamp:2}.vu{letter-spacing:0}.wc{padding-top:16px}.wl{max-width:56%}.wm{flex:1 0 0}.wu{margin-bottom:24px}.wx{flex-direction:row}.xj{width:min-width}.xs{margin-left:16px}.xx{margin-top:96px}.yn{margin-top:24px}.yo{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.ka{margin-top:0px}.oh{margin-left:auto}.oi{text-align:center}.ph{display:inline-block}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.jz{margin-top:0px}.pg{display:inline-block}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.jx{margin-top:0px}.jy{margin-right:0px}.pf{display:inline-block}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.s{display:flex}.t{justify-content:space-between}.br{width:24px}.cb{margin:0 24px}.cq{height:40px}.cx{margin-bottom:44px}.dj{margin-bottom:32px}.ds{margin-bottom:4px}.ex{font-size:32px}.ey{margin-top:1.01em}.ez{margin-bottom:24px}.fa{line-height:38px}.fb{letter-spacing:-0.014em}.gb{align-items:flex-start}.hi{flex-direction:column}.hl{margin-bottom:2px}.hz{margin:24px -24px 0}.ia{padding:0}.ip> *{margin-right:8px}.iq> :last-child{margin-right:24px}.ji{margin-left:0px}.jv{margin-top:0px}.jw{margin-right:0px}.ko{border:1px solid #F2F2F2}.kp{border-radius:99em}.kq{padding:0px 16px 0px 12px}.kr{height:38px}.ks{align-items:center}.ku svg{margin-right:8px}.lf{font-size:18px}.lg{margin-top:1.56em}.lh{line-height:28px}.li{letter-spacing:-0.003em}.md{font-size:20px}.me{margin-top:1.2em}.mf{line-height:24px}.mg{letter-spacing:0}.my{margin-top:0.67em}.ne{margin-top:40px}.ot{margin-bottom:80px}.pe{display:inline-block}.pk{padding-top:48px}.rg{margin-top:32px}.rq{margin:0}.ry{width:calc(100% + 24px)}.rz{margin-left:-12px}.sa{margin-right:-12px}.sn{padding-left:12px}.so{padding-right:12px}.sp{flex-basis:100%}.sq{max-width:100%}.ti{padding-bottom:32px}.tr{gap:24px 0}.ts{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.ud{display:block}.um{margin-bottom:16px}.uv{padding-bottom:16px}.uw{flex:1 0 auto}.vf{max-height:48px}.vg{-webkit-line-clamp:2}.vy{padding-top:16px}.wd{max-width:56%}.we{flex:1 0 0}.xf{width:100%}.xk{margin-left:0}.xl{margin-top:16px}.xt{margin-top:72px}.kt:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.bu{width:64px}.ce{margin:0 64px}.ct{height:48px}.da{margin-bottom:52px}.dm{margin-bottom:48px}.dv{margin-bottom:68px}.dz{max-width:680px}.fm{font-size:42px}.fn{margin-top:1.19em}.fo{margin-bottom:32px}.fp{line-height:52px}.fq{letter-spacing:-0.011em}.ge{align-items:center}.ih{border-top:solid 1px #F2F2F2}.ii{border-bottom:solid 1px #F2F2F2}.ij{margin:32px 0 0}.ik{padding:3px 8px}.iv> *{margin-right:24px}.iw> :last-child{margin-right:0}.je{display:flex}.lr{font-size:20px}.ls{margin-top:2em}.lt{line-height:32px}.lu{letter-spacing:-0.003em}.mp{font-size:24px}.mq{margin-top:1.95em}.mr{line-height:30px}.ms{letter-spacing:-0.016em}.nb{margin-top:0.86em}.nh{margin-top:56px}.ow{margin-bottom:88px}.pn{padding-top:72px}.rj{margin-top:40px}.rt{margin:0}.sh{width:calc(100% + 32px)}.si{margin-left:-16px}.sj{margin-right:-16px}.sz{padding-left:16px}.ta{padding-right:16px}.tb{flex-basis:50%}.tc{max-width:50%}.tl{padding-bottom:56px}.tx{gap:24px 0}.ty{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.ug{display:block}.up{margin-bottom:16px}.vb{padding-bottom:16px}.vc{flex:1 0 auto}.vn{line-height:24px}.vo{max-height:48px}.vp{-webkit-line-clamp:2}.vq{letter-spacing:0}.wb{padding-top:16px}.wj{max-width:56%}.wk{flex:1 0 0}.wt{margin-bottom:24px}.ww{flex-direction:row}.xi{width:min-width}.xq{margin-left:16px}.xr{margin-top:0px}.xw{margin-top:96px}.yl{margin-top:24px}.ym{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.w{display:flex}.x{justify-content:space-between}.bt{width:64px}.cd{margin:0 48px}.cs{height:48px}.cz{margin-bottom:52px}.dl{margin-bottom:48px}.du{margin-bottom:68px}.dy{max-width:680px}.fh{font-size:42px}.fi{margin-top:1.19em}.fj{margin-bottom:32px}.fk{line-height:52px}.fl{letter-spacing:-0.011em}.gd{align-items:center}.id{border-top:solid 1px #F2F2F2}.ie{border-bottom:solid 1px #F2F2F2}.if{margin:32px 0 0}.ig{padding:3px 8px}.it> *{margin-right:24px}.iu> :last-child{margin-right:0}.ln{font-size:20px}.lo{margin-top:2em}.lp{line-height:32px}.lq{letter-spacing:-0.003em}.ml{font-size:24px}.mm{margin-top:1.95em}.mn{line-height:30px}.mo{letter-spacing:-0.016em}.na{margin-top:0.86em}.ng{margin-top:56px}.ov{margin-bottom:88px}.pm{padding-top:72px}.ri{margin-top:40px}.rs{margin:0}.se{width:calc(100% + 28px)}.sf{margin-left:-14px}.sg{margin-right:-14px}.sv{padding-left:14px}.sw{padding-right:14px}.sx{flex-basis:50%}.sy{max-width:50%}.tk{padding-bottom:56px}.tv{gap:24px 0}.tw{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.uf{display:block}.uo{margin-bottom:16px}.uz{padding-bottom:16px}.va{flex:1 0 auto}.vj{line-height:24px}.vk{max-height:48px}.vl{-webkit-line-clamp:2}.vm{letter-spacing:0}.wa{padding-top:16px}.wh{max-width:56%}.wi{flex:1 0 0}.ws{margin-bottom:24px}.wv{flex-direction:row}.xh{width:min-width}.xo{margin-left:16px}.xp{margin-top:0px}.xv{margin-top:96px}.yj{margin-top:24px}.yk{margin-bottom:56px}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.u{display:flex}.v{justify-content:space-between}.bs{width:24px}.cc{margin:0 24px}.cr{height:40px}.cy{margin-bottom:44px}.dk{margin-bottom:32px}.dt{margin-bottom:4px}.fc{font-size:32px}.fd{margin-top:1.01em}.fe{margin-bottom:24px}.ff{line-height:38px}.fg{letter-spacing:-0.014em}.gc{align-items:flex-start}.hj{flex-direction:column}.hm{margin-bottom:2px}.ib{margin:24px 0 0}.ic{padding:0}.ir> *{margin-right:8px}.is> :last-child{margin-right:8px}.jj{margin-left:0px}.kv{border:1px solid #F2F2F2}.kw{border-radius:99em}.kx{padding:0px 16px 0px 12px}.ky{height:38px}.kz{align-items:center}.lb svg{margin-right:8px}.lj{font-size:18px}.lk{margin-top:1.56em}.ll{line-height:28px}.lm{letter-spacing:-0.003em}.mh{font-size:20px}.mi{margin-top:1.2em}.mj{line-height:24px}.mk{letter-spacing:0}.mz{margin-top:0.67em}.nf{margin-top:40px}.ou{margin-bottom:80px}.pl{padding-top:48px}.rh{margin-top:32px}.rr{margin:0}.sb{width:calc(100% + 24px)}.sc{margin-left:-12px}.sd{margin-right:-12px}.sr{padding-left:12px}.ss{padding-right:12px}.st{flex-basis:100%}.su{max-width:100%}.tj{padding-bottom:32px}.tt{gap:24px 0}.tu{grid-template-areas:"image image image image image image image image image image image image" "content content content content content content content content content content content content"}.ue{display:block}.un{margin-bottom:16px}.ux{padding-bottom:16px}.uy{flex:1 0 auto}.vh{max-height:48px}.vi{-webkit-line-clamp:2}.vz{padding-top:16px}.wf{max-width:56%}.wg{flex:1 0 0}.xg{width:100%}.xm{margin-left:0}.xn{margin-top:16px}.xu{margin-top:72px}.la:hover{border-color:#E5E5E5}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="print">.pc{display:none}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="(orientation: landscape) and (max-width: 903.98px)">.hw{max-height:none}</style><style type="text/css" data-fela-rehydration="664" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.oa{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}</style></head><body><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div class="l c"><div class="l m n o c"><div class="p q r s t u v w x i d y z"></div><div class="p q r ab ac"><div class="ab q ae"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab" aria-label="Homepage" data-testid="headerMediumLogo" rel="noopener follow" href="/?source=---two_column_layout_nav----------------------------------"><svg viewBox="0 0 3940 610" class="au av"><path d="M594.79 308.2c0 163.76-131.85 296.52-294.5 296.52S5.8 472 5.8 308.2 137.65 11.69 300.29 11.69s294.5 132.75 294.5 296.51M917.86 308.2c0 154.16-65.93 279.12-147.25 279.12s-147.25-125-147.25-279.12S689.29 29.08 770.61 29.08s147.25 125 147.25 279.12M1050 308.2c0 138.12-23.19 250.08-51.79 250.08s-51.79-112-51.79-250.08 23.19-250.08 51.8-250.08S1050 170.09 1050 308.2M1862.77 37.4l.82-.18v-6.35h-167.48l-155.51 365.5-155.51-365.5h-180.48v6.35l.81.18c30.57 6.9 46.09 17.19 46.09 54.3v434.45c0 37.11-15.58 47.4-46.15 54.3l-.81.18V587H1327v-6.35l-.81-.18c-30.57-6.9-46.09-17.19-46.09-54.3V116.9L1479.87 587h11.33l205.59-483.21V536.9c-2.62 29.31-18 38.36-45.68 44.61l-.82.19v6.3h213.3v-6.3l-.82-.19c-27.71-6.25-43.46-15.3-46.08-44.61l-.14-445.2h.14c0-37.11 15.52-47.4 46.08-54.3m97.43 287.8c3.49-78.06 31.52-134.4 78.56-135.37 14.51.24 26.68 5 36.14 14.16 20.1 19.51 29.55 60.28 28.09 121.21zm-2.11 22h250v-1.05c-.71-59.69-18-106.12-51.34-138-28.82-27.55-71.49-42.71-116.31-42.71h-1c-23.26 0-51.79 5.64-72.09 15.86-23.11 10.7-43.49 26.7-60.45 47.7-27.3 33.83-43.84 79.55-47.86 130.93-.13 1.54-.24 3.08-.35 4.62s-.18 2.92-.25 4.39a332.64 332.64 0 0 0-.36 21.69C1860.79 507 1923.65 600 2035.3 600c98 0 155.07-71.64 169.3-167.8l-7.19-2.53c-25 51.68-69.9 83-121 79.18-69.76-5.22-123.2-75.95-118.35-161.63m532.69 157.68c-8.2 19.45-25.31 30.15-48.24 30.15s-43.89-15.74-58.78-44.34c-16-30.7-24.42-74.1-24.42-125.51 0-107 33.28-176.21 84.79-176.21 21.57 0 38.55 10.7 46.65 29.37zm165.84 76.28c-30.57-7.23-46.09-18-46.09-57V5.28L2424.77 60v6.7l1.14-.09c25.62-2.07 43 1.47 53.09 10.79 7.9 7.3 11.75 18.5 11.75 34.26v71.14c-18.31-11.69-40.09-17.38-66.52-17.38-53.6 0-102.59 22.57-137.92 63.56-36.83 42.72-56.3 101.1-56.3 168.81C2230 518.72 2289.53 600 2378.13 600c51.83 0 93.53-28.4 112.62-76.3V588h166.65v-6.66zm159.29-505.33c0-37.76-28.47-66.24-66.24-66.24-37.59 0-67 29.1-67 66.24s29.44 66.24 67 66.24c37.77 0 66.24-28.48 66.24-66.24m43.84 505.33c-30.57-7.23-46.09-18-46.09-57h-.13V166.65l-166.66 47.85v6.5l1 .09c36.06 3.21 45.93 15.63 45.93 57.77V588h166.8v-6.66zm427.05 0c-30.57-7.23-46.09-18-46.09-57V166.65L3082 212.92v6.52l.94.1c29.48 3.1 38 16.23 38 58.56v226c-9.83 19.45-28.27 31-50.61 31.78-36.23 0-56.18-24.47-56.18-68.9V166.66l-166.66 47.85V221l1 .09c36.06 3.2 45.94 15.62 45.94 57.77v191.27a214.48 214.48 0 0 0 3.47 39.82l3 13.05c14.11 50.56 51.08 77 109 77 49.06 0 92.06-30.37 111-77.89v66h166.66v-6.66zM3934.2 588v-6.67l-.81-.19c-33.17-7.65-46.09-22.07-46.09-51.43v-243.2c0-75.83-42.59-121.09-113.93-121.09-52 0-95.85 30.05-112.73 76.86-13.41-49.6-52-76.86-109.06-76.86-50.12 0-89.4 26.45-106.25 71.13v-69.87l-166.66 45.89v6.54l1 .09c35.63 3.16 45.93 15.94 45.93 57V588h155.5v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66V255.72c7-16.35 21.11-35.72 49-35.72 34.64 0 52.2 24 52.2 71.28V588h155.54v-6.66l-.82-.2c-26.46-6.22-35-17.56-35-46.66v-248a160.45 160.45 0 0 0-2.2-27.68c7.42-17.77 22.34-38.8 51.37-38.8 35.13 0 52.2 23.31 52.2 71.28V588z"></path></svg></a><div class="aw h"><div class="ab ax ay az ba q bb bc"><div class="bl" aria-hidden="false" aria-describedby="searchResults" aria-labelledby="searchResults"></div><div class="bm bn ab"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.1 11.06a6.95 6.95 0 1 1 13.9 0 6.95 6.95 0 0 1-13.9 0zm6.94-8.05a8.05 8.05 0 1 0 5.13 14.26l3.75 3.75a.56.56 0 1 0 .8-.79l-3.74-3.73A8.05 8.05 0 0 0 11.04 3v.01z" fill="currentColor"></path></svg></div><input role="combobox" aria-controls="searchResults" aria-expanded="false" aria-label="search" data-testid="headerSearchInput" tabindex="0" class="ax bd be bf z bg bh bi bj bk" placeholder="Search" value=""/></div></div></div><div class="bo bp bq br bs bt bu bv bw"></div><div class="bo bp bq br h bs k bt bu bv bw"></div><div class="bo bp bq br h bs k bt bu bv bw"></div><div class="bx bp by bz bw"></div></div></div><div class="l"><div class="ds dt du dv dw l"><div class="ab ca"><div class="ch bg dx dy dz ea"></div></div><article><div class="l"><div class="l"><span class="l"></span><section><div><div class="eh ei ej ek el em"></div><div class="eo ep eq er es"><div class="ab ca"><div class="ch bg dx dy dz ea"><div><h1 id="214d" class="pw-post-title et eu ev be ew ex ey ez fa fb fc fd fe ff fg fh fi fj fk fl fm fn fo fp fq fr fs ft fu fv bj" data-testid="storyTitle">Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions</h1><div class="fw fx fy fz ga"><div class="speechify-ignore ab co"><div class="speechify-ignore bg l"><div class="gb gc gd ge gf ab"><div><div class="ab gg"><a rel="noopener follow" href="/@sametkaradag?source=post_page-----fc8fbbd5f5de--------------------------------"><div><div class="bl" aria-hidden="false"><div class="l gh gi bx gj gk"><div class="l go"><img alt="Samet Karadag" class="l ec bx dc dd cw" src="https://miro.medium.com/v2/resize:fill:88:88/2*ld3faQ48JO_K1GCBgGfKdg.jpeg" width="44" height="44" loading="lazy" data-testid="authorPhoto"/><div class="gl bx l dc dd eh n gm gn"></div></div></div></div></div></a><a href="https://medium.com/google-cloud?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><div class="gp ab go"><div><div class="bl" aria-hidden="false"><div class="l gq gr bx gj gs"><div class="l go"><img alt="Google Cloud - Community" class="l ec bx bq gt cw" src="https://miro.medium.com/v2/resize:fill:48:48/1*FUjLiCANvATKeaJEeg20Rw.png" width="24" height="24" loading="lazy" data-testid="publicationPhoto"/><div class="gl bx l bq gt eh n gm gn"></div></div></div></div></div></div></a></div></div><div class="bm bg l"><div class="ab"><div style="flex:1"><span class="be b bf z bj"><div class="gu ab q"><div class="ab q gv"><div class="ab q"><div><div class="bl" aria-hidden="false"><p class="be b gw gx bj"><a class="af ag ah ai aj ak al am an ao ap aq ar gy" data-testid="authorName" rel="noopener follow" href="/@sametkaradag?source=post_page-----fc8fbbd5f5de--------------------------------">Samet Karadag</a></p></div></div></div><span class="gz ha" aria-hidden="true"><span class="be b bf z hb">·</span></span><p class="be b gw gx hb"><span><a class="hc hd ah ai aj ak al am an ao ap aq ar he hf hg" rel="noopener follow" href="/m/signin?actionUrl=https%3A%2F%2Fmedium.com%2F_%2Fsubscribe%2Fuser%2F9e3062ccc5be&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de&amp;user=Samet+Karadag&amp;userId=9e3062ccc5be&amp;source=post_page-9e3062ccc5be----fc8fbbd5f5de---------------------post_header-----------">Follow</a></span></p></div></div></span></div></div><div class="l hh"><span class="be b bf z hb"><div class="ab cm hi hj hk"><div class="hl hm ab"><div class="be b bf z hb ab hn"><span class="ho l hh">Published in</span><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" data-testid="publicationName" href="https://medium.com/google-cloud?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b bf z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div><div class="h k"><span class="gz ha" aria-hidden="true"><span class="be b bf z hb">·</span></span></div></div><span class="be b bf z hb"><div class="ab ae"><span data-testid="storyReadTime">5 min read</span><div class="hx hy l" aria-hidden="true"><span class="l" aria-hidden="true"><span class="be b bf z hb">·</span></span></div>1 day ago</div></span></div></span></div></div></div><div class="ab co hz ia ib ic id ie if ig ih ii ij ik il im in io"><div class="h k w je jf q"><div class="jg l"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div></div><div><div class="bl" aria-hidden="false"><button class="ao jl kd ke ab q kf kg kh" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ki"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div><div class="ab q ip iq ir is it iu iv iw ix iy iz ja jb jc jd"><div class="kj k j i d"></div><div class="h k"></div><div class="ec rp cm"><div class="l ae"><div class="ab ca"><div class="rq rr rs rt ru nw ch bg"><div class="ab"><div class="bl bg" aria-hidden="false"><div><div class="bl" aria-hidden="false"><button aria-label="Listen" data-testid="audioPlayButton" class="af kf ah ai aj ak al kk an ao ap he kl km kh kn ko kp kq kr s ks kt ku kv kw kx ky u kz la lb"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 12a9 9 0 1 1 18 0 9 9 0 0 1-18 0zm9-10a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm3.38 10.42l-4.6 3.06a.5.5 0 0 1-.78-.41V8.93c0-.4.45-.63.78-.41l4.6 3.06c.3.2.3.64 0 .84z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z hb">Listen</p></div></button></div></div></div></div></div></div></div></div><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="headerSocialShareButton" class="af kf ah ai aj ak al kk an ao ap he kl km kh kn ko kp kq kr s ks kt ku kv kw kx ky u kz la lb"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg><div class="j i d"><p class="be b bf z hb">Share</p></div></button></div></div></div></div></div></div></div></div></div><p id="81b7" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and curates it based on where it came from. We’ll use Cloud Workflows triggered by GCS events and Cloud Functions to do this.</p><h1 id="1729" class="ma mb ev be mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bj">Step 1: Create a Cloud Function to load data from GCS to BigQuery</h1><p id="a8c8" class="pw-post-body-paragraph lc ld ev le b lf my lh li lj mz ll lm ln na lp lq lr nb lt lu lv nc lx ly lz eo bj">In my <a class="af nd" rel="noopener" href="/google-cloud/streamline-your-data-ingestion-with-event-driven-loads-into-bigquery-from-gcs-using-cloud-functions-e1e2e3d376bf">previous post</a> I wrote about how to streamline data ingestion with event-driven serverless loads into BigQuery from GCS using Cloud Functions triggered by new uploads.</p><p id="d0ab" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">We will use the same function with some changes to trigger it via Workflows rather than GCS.</p><p id="cff6" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">Here is the updated cloud function that is triggered via pubsub and workflows (please read <a class="af nd" rel="noopener" href="/google-cloud/streamline-your-data-ingestion-with-event-driven-loads-into-bigquery-from-gcs-using-cloud-functions-e1e2e3d376bf">my previous post</a> for more details on this function):</p><pre class="ne nf ng nh ni nj nk nl bo nm ba bj"><span id="a90b" class="nn mb ev nk b bf no np l nq nr">import os<br/>import json<br/>from google.cloud import bigquery<br/>from google.cloud import storage<br/>import functions_framework<br/>import time<br/>import datetime<br/>from flask import jsonify<br/><br/># Set your GCS bucket and BigQuery dataset and table names<br/>BIGQUERY_DATASET_ID = &#x27;ingestion&#x27;<br/><br/>def prepare_json_file(file_bucket, file_name):<br/>    # Initialize GCS client<br/>    storage_client = storage.Client()<br/>    temp_file_name = &#x27;./&#x27;+file_bucket+&#x27;_&#x27;+file_name <br/><br/>    # Download the file from GCS to a local temporary file<br/>    bucket = storage_client.bucket(file_bucket)<br/>    blob = bucket.blob(file_name)<br/>    blob.download_to_filename(temp_file_name)<br/><br/>    # Read the content of the temporary file<br/>    with open(temp_file_name, &#x27;r&#x27;) as file:<br/>    #     lines = file.readlines()<br/>        json_file = json.load(file)<br/><br/>    records = [json.dumps(record) for record in json_file[&quot;records&quot;]] <br/><br/>    newline_delimited_json = &#x27;\n&#x27;.join(records)<br/><br/>    # Check if the file has at least 2 lines<br/>    if len(newline_delimited_json) &gt;= 2:<br/><br/>        # # Write the modified content to a new temporary file<br/>        with open(temp_file_name, &#x27;w&#x27;) as file:<br/>            file.writelines(newline_delimited_json)<br/><br/>        # Upload the modified file to GCS, to the process_json bucket<br/>        bucket = storage_client.bucket(&#x27;preprocess_json&#x27;)<br/>        blob = bucket.blob(file_name)<br/>        blob.upload_from_filename(temp_file_name)<br/>        print(f&quot;Converted &#x27;{file_name}&#x27; to newline_delimited_json format in GCS bucket &#x27;{file_bucket}&#x27;.&quot;)<br/><br/>    else:<br/>        print(&quot;The file does not have enough lines to remove the first and last lines.&quot;)<br/><br/>    # Clean up the local temporary file<br/>    os.remove(temp_file_name)<br/>    return file_name<br/><br/><br/>def get_table_schema(table_id):<br/>    # Initialize BigQuery client<br/>    bigquery_client = bigquery.Client()<br/><br/>    # Get the schema of the existing table<br/>    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(table_id)<br/>    table = bigquery_client.get_table(table_ref)<br/><br/>    return table.schema<br/><br/>def create_empty_table(table_id, schema):<br/>    # Initialize BigQuery client<br/>    bigquery_client = bigquery.Client()<br/><br/>    # Construct the BigQuery table reference<br/>    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(table_id)<br/><br/>    # Define the schema for the new table<br/>    table = bigquery.Table(table_ref, schema=schema)<br/><br/>    # set table to expire 5 days from now<br/>    expiration = datetime.datetime.now(datetime.timezone.utc) + datetime.timedelta(<br/>        days=1<br/>    )<br/><br/>    table.expires = expiration<br/><br/>    # Create the empty table in BigQuery<br/>    bigquery_client.create_table(table)<br/><br/>    print(f&quot;Empty table {table_id} created in BigQuery.&quot;)<br/><br/>def load_data_to_bigquery(data):<br/>    # Get the file details from the event<br/>    file_name = data[&#x27;objectId&#x27;]<br/>    file_bucket = data[&#x27;bucketId&#x27;]<br/><br/>    BIGQUERY_TABLE_ID = file_bucket.split(&#x27;-&#x27;)[1].upper()<br/>    # Create a new table name with a timestamp epoch<br/>    epoch_timestamp = str(int(time.time()*1000000))<br/>    new_table_name = f&quot;{BIGQUERY_TABLE_ID}_{epoch_timestamp}&quot;<br/><br/>    # Initialize BigQuery and Storage clients<br/>    bigquery_client = bigquery.Client()<br/>    storage_client = storage.Client()<br/><br/>    # Construct the BigQuery table reference<br/>    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(BIGQUERY_TABLE_ID)<br/><br/>    # Get the schema from an existing table (e.g., ingestion.DP1)<br/>    schema = bigquery_client.get_table(table_ref).schema  # Change to the desired table<br/><br/>    # Construct the BigQuery table reference<br/>    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(new_table_name)<br/><br/>    # Create a new empty table with the same schema as the existing table<br/>    create_empty_table(new_table_name, schema)<br/><br/>    # Define job configuration<br/>    job_config = bigquery.LoadJobConfig(<br/>        autodetect=True,<br/>        source_format=bigquery.SourceFormat.CSV if file_name.endswith(&#x27;.csv&#x27;) else bigquery.SourceFormat.NEWLINE_DELIMITED_JSON,<br/>        write_disposition=bigquery.WriteDisposition.WRITE_TRUNCATE,<br/>    )<br/><br/>    # If it is a JSON file remove first and last line to convert it to newline_delimited_json rather than an array<br/>    if file_name.endswith(&#x27;.json&#x27;):<br/>        file_name = prepare_json_file(file_bucket, file_name)<br/>        file_bucket = &#x27;preprocess_json&#x27;<br/><br/>    # Load data from GCS to BigQuery<br/>    uri = f&quot;gs://{file_bucket}/{file_name}&quot;<br/>    load_job = bigquery_client.load_table_from_uri(uri, table_ref, job_config=job_config)<br/><br/>    load_job.result()  # Wait for the job to complete<br/><br/>    print(f&quot;File {file_name} loaded into BigQuery table {BIGQUERY_DATASET_ID}.{new_table_name}&quot;)<br/>    return new_table_name<br/><br/># Entry point for Cloud Function<br/># Triggered by pubsub<br/>@functions_framework.http<br/>def main(request):<br/>    # data = request.data.message.attributes<br/>    print(request)<br/>    request_json = request.get_json(silent=True)<br/>    request_args = request.args<br/>    print(request_json)<br/><br/>    if request_json and &#x27;input&#x27; in request_json:<br/>        data = request_json[&#x27;input&#x27;][&#x27;data&#x27;][&#x27;message&#x27;][&#x27;attributes&#x27;]<br/>            <br/>        bucket = data[&quot;bucketId&quot;]<br/>        name = data[&quot;objectId&quot;]<br/>        timeCreated = data[&quot;eventTime&quot;]<br/>    else:<br/>        raise ValueError(&quot;JSON is invalid, or missing a &#x27;data&#x27; property&quot;)<br/><br/>    <br/>    print(f&quot;Data: {data}&quot;)<br/><br/>    print(f&quot;Bucket: {bucket}&quot;)<br/>    print(f&quot;File: {name}&quot;)<br/>    print(f&quot;Created: {timeCreated}&quot;)<br/><br/>    return_msg = load_data_to_bigquery(data)<br/><br/>    return jsonify({ &#x27;table_name&#x27; :  return_msg })<br/></span></pre><h1 id="47c3" class="ma mb ev be mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bj">Step 2: Create a Cloud Function to curate the data</h1><p id="677d" class="pw-post-body-paragraph lc ld ev le b lf my lh li lj mz ll lm ln na lp lq lr nb lt lu lv nc lx ly lz eo bj">Here is a sample Cloud Function which transforms data from the staging table to the curated table based on its type which is embedded in the table_name;</p><pre class="ne nf ng nh ni nj nk nl bo nm ba bj"><span id="22b9" class="nn mb ev nk b bf no np l nq nr">import os<br/>from google.cloud import bigquery<br/>from google.cloud import storage<br/>import functions_framework<br/><br/><br/># Initialize the BigQuery client<br/>bq_client = bigquery.Client()<br/><br/>@functions_framework.http<br/>def curate(request):<br/>    request_json = request.get_json(silent=True)<br/>    request_args = request.args<br/>    print(request_json)<br/><br/>    if request_json and &#x27;input&#x27; in request_json:<br/>        table_name = request_json[&#x27;input&#x27;][&#x27;body&#x27;][&#x27;table_name&#x27;]<br/>    else:<br/>        raise ValueError(&quot;JSON is invalid, or missing a &#x27;table_name&#x27; property&quot;)<br/><br/><br/><br/>    # Define the SQL queries for DP1 and DP2<br/>    t1_query = f&quot;&quot;&quot;<br/>    INSERT INTO curated.common_target (<br/>        &lt;column_list&gt;<br/>    )<br/>    SELECT<br/>        &lt;column_list with required mappings&gt;<br/>    FROM ingestion.{table_name} T<br/>    JOIN `project_id.curated.lookup` c on (t.lookupcol1 = c.C1 or t.lookupcol1 = c.C2)<br/>    &quot;&quot;&quot; <br/><br/>    t2_query = f&quot;&quot;&quot;<br/>    INSERT INTO curated.common_target (<br/>        &lt;column_list&gt;<br/>    )<br/>    SELECT<br/>       &lt;column_list with required mappings&gt;<br/>    FROM ingestion.{table_name} t<br/>    JOIN `project_id.curated.lookup` c on (t.lookupcol1 = c.C1 or t.lookupcol1 = c.C2)<br/>    &quot;&quot;&quot;<br/><br/>    # Determine which query to execute based on the table name suffix<br/>    data_type = table_name.split(&quot;_&quot;)[0]<br/>    if data_type == &#x27;T1&#x27;:<br/>        query = t1_query<br/>    elif data_type == &#x27;T2&#x27;:<br/>        query = t2_query<br/>    else:<br/>        raise ValueError(f&quot;Unsupported table name: {table_name}&quot;)<br/><br/>    # Execute the SQL query<br/>    job_config = bigquery.QueryJobConfig()<br/>    query_job = bq_client.query(query, job_config=job_config)<br/><br/>    # Wait for the query job to complete<br/>    query_job.result()<br/><br/>    print(f&quot;Curated data for input data type {data_type}&quot;)<br/>    return (f&quot;Curated data for input data type {data_type}&quot;)<br/></span></pre><h1 id="20f8" class="ma mb ev be mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bj">Step 3: Create a workflow to trigger the Cloud Functions</h1><p id="47bd" class="pw-post-body-paragraph lc ld ev le b lf my lh li lj mz ll lm ln na lp lq lr nb lt lu lv nc lx ly lz eo bj">Here is a sample workflow which is triggered by Eventarc pubsub message and runs load and curate functions per file.</p><figure class="ne nf ng nh ni nv ns nt paragraph-image"><div class="ns nt nu"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 1100w, https://miro.medium.com/v2/resize:fit:924/format:webp/1*MbjpDYnhlwdiTkkNQcq2wA.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*MbjpDYnhlwdiTkkNQcq2wA.png 640w, https://miro.medium.com/v2/resize:fit:720/1*MbjpDYnhlwdiTkkNQcq2wA.png 720w, https://miro.medium.com/v2/resize:fit:750/1*MbjpDYnhlwdiTkkNQcq2wA.png 750w, https://miro.medium.com/v2/resize:fit:786/1*MbjpDYnhlwdiTkkNQcq2wA.png 786w, https://miro.medium.com/v2/resize:fit:828/1*MbjpDYnhlwdiTkkNQcq2wA.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*MbjpDYnhlwdiTkkNQcq2wA.png 1100w, https://miro.medium.com/v2/resize:fit:924/1*MbjpDYnhlwdiTkkNQcq2wA.png 924w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 462px"/><img alt="" class="bg nw nx c" width="462" height="972" loading="lazy" role="presentation"/></picture></div></figure><p id="24a4" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">1. Goto Workflows page in GCP and Click the “Create Workflow” button.<br/>2. Enter a name for the workflow, such as `gcs_to_bq_load_curate`.<br/>3. Click the ‘Add trigger’ button.<br/>4. Select the ‘Eventarc’ trigger.</p><figure class="ne nf ng nh ni nv ns nt paragraph-image"><div class="ns nt ny"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 1100w, https://miro.medium.com/v2/resize:fit:872/format:webp/1*oRu5axmyLy7g9Vfq8XYJWQ.png 872w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 436px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*oRu5axmyLy7g9Vfq8XYJWQ.png 640w, https://miro.medium.com/v2/resize:fit:720/1*oRu5axmyLy7g9Vfq8XYJWQ.png 720w, https://miro.medium.com/v2/resize:fit:750/1*oRu5axmyLy7g9Vfq8XYJWQ.png 750w, https://miro.medium.com/v2/resize:fit:786/1*oRu5axmyLy7g9Vfq8XYJWQ.png 786w, https://miro.medium.com/v2/resize:fit:828/1*oRu5axmyLy7g9Vfq8XYJWQ.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*oRu5axmyLy7g9Vfq8XYJWQ.png 1100w, https://miro.medium.com/v2/resize:fit:872/1*oRu5axmyLy7g9Vfq8XYJWQ.png 872w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 436px"/><img alt="" class="bg nw nx c" width="436" height="376" loading="lazy" role="presentation"/></picture></div></figure><figure class="ne nf ng nh ni nv ns nt paragraph-image"><div role="button" tabindex="0" class="oa ob go oc bg od"><div class="ns nt nz"><picture><source srcSet="https://miro.medium.com/v2/resize:fit:640/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 640w, https://miro.medium.com/v2/resize:fit:720/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 720w, https://miro.medium.com/v2/resize:fit:750/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 750w, https://miro.medium.com/v2/resize:fit:786/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 786w, https://miro.medium.com/v2/resize:fit:828/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/format:webp/1*AOk32OrgMsYRodL7cc3IEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px" type="image/webp"/><source data-testid="og" srcSet="https://miro.medium.com/v2/resize:fit:640/1*AOk32OrgMsYRodL7cc3IEg.png 640w, https://miro.medium.com/v2/resize:fit:720/1*AOk32OrgMsYRodL7cc3IEg.png 720w, https://miro.medium.com/v2/resize:fit:750/1*AOk32OrgMsYRodL7cc3IEg.png 750w, https://miro.medium.com/v2/resize:fit:786/1*AOk32OrgMsYRodL7cc3IEg.png 786w, https://miro.medium.com/v2/resize:fit:828/1*AOk32OrgMsYRodL7cc3IEg.png 828w, https://miro.medium.com/v2/resize:fit:1100/1*AOk32OrgMsYRodL7cc3IEg.png 1100w, https://miro.medium.com/v2/resize:fit:1400/1*AOk32OrgMsYRodL7cc3IEg.png 1400w" sizes="(min-resolution: 4dppx) and (max-width: 700px) 50vw, (-webkit-min-device-pixel-ratio: 4) and (max-width: 700px) 50vw, (min-resolution: 3dppx) and (max-width: 700px) 67vw, (-webkit-min-device-pixel-ratio: 3) and (max-width: 700px) 65vw, (min-resolution: 2.5dppx) and (max-width: 700px) 80vw, (-webkit-min-device-pixel-ratio: 2.5) and (max-width: 700px) 80vw, (min-resolution: 2dppx) and (max-width: 700px) 100vw, (-webkit-min-device-pixel-ratio: 2) and (max-width: 700px) 100vw, 700px"/><img alt="" class="bg nw nx c" width="700" height="643" loading="lazy" role="presentation"/></picture></div></div><figcaption class="oe of og ns nt oh oi be b bf z hb">Eventarc Trigger</figcaption></figure><p id="4243" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">5- Provide YAML configuration on the next page.</p><p id="3bad" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">Workflow YAML:</p><pre class="ne nf ng nh ni nj nk nl bo nm ba bj"><span id="ba86" class="nn mb ev nk b bf no np l nq nr">main:<br/>  params: [event]<br/>  steps:<br/>    - logStep:<br/>        call: sys.log<br/>        args:<br/>            text: ${event}<br/>            severity: INFO<br/>    - gcs_to_bq_load:<br/>        call: http.post<br/>        args:<br/>            url: https://us-central1-project-id.cloudfunctions.net/gcs_to_bq <br/>            body:<br/>                input: ${event}<br/>            auth:<br/>              type: OIDC<br/>        result: gcs_to_bq_result<br/>        next: curate_common<br/><br/><br/>    - curate_common: <br/>        call: http.post<br/>        args:<br/>            url: https://us-central1-project-id.cloudfunctions.net/curate-to-common<br/>            body:<br/>                input: ${gcs_to_bq_result}<br/>            auth:<br/>              type: OIDC<br/>        result: curate_result</span></pre><h1 id="c5c7" class="ma mb ev be mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt mu mv mw mx bj">Step 4: Create GCS Event Triggers</h1><p id="9734" class="pw-post-body-paragraph lc ld ev le b lf my lh li lj mz ll lm ln na lp lq lr nb lt lu lv nc lx ly lz eo bj">Now we have our Cloud Workflow is ready and listening to pubsub messages. Final piece that we need is to create GCS event trigger to publish a message whenever a file is uploaded.</p><p id="747d" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">You can do it in Cloud Shell or your terminal with the following cmd;</p><pre class="ne nf ng nh ni nj nk nl bo nm ba bj"><span id="cd4e" class="nn mb ev nk b bf no np l nq nr">#Add notification for the first source bucket<br/>gcloud storage buckets notifications create --event-types=OBJECT_FINALIZE gs://input-bucket1 --topic projects/project-id/topics/gcs_upload_event_trigger<br/><br/>#If you want to listen multiple buckets add notifications for those buckets as well<br/>gcloud storage buckets notifications create --event-types=OBJECT_FINALIZE gs://input-bucket2 --topic projects/project-id/topics/gcs_upload_event_trigger</span></pre><p id="d355" class="pw-post-body-paragraph lc ld ev le b lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz eo bj">Now we have the copmplete event-driven serverless data pipeline to automatically load from gcs to bq and curate. Please let me know what you think or if you have any questions.</p></div></div></div></div></section></div></div></article><div class="ab ca"><div class="ch bg dx dy dz ea"></div></div></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="oj ok ab hk"><div class="ol ab"><a class="om ax am ao" rel="noopener follow" href="/tag/bigquery?source=post_page-----fc8fbbd5f5de---------------bigquery-----------------"><div class="on go cw oo ed op oq be b bf z bj or">Bigquery</div></a></div><div class="ol ab"><a class="om ax am ao" rel="noopener follow" href="/tag/gcp-workflows?source=post_page-----fc8fbbd5f5de---------------gcp_workflows-----------------"><div class="on go cw oo ed op oq be b bf z bj or">Gcp Workflows</div></a></div><div class="ol ab"><a class="om ax am ao" rel="noopener follow" href="/tag/cloud-functions?source=post_page-----fc8fbbd5f5de---------------cloud_functions-----------------"><div class="on go cw oo ed op oq be b bf z bj or">Cloud Functions</div></a></div><div class="ol ab"><a class="om ax am ao" rel="noopener follow" href="/tag/event-driven-architecture?source=post_page-----fc8fbbd5f5de---------------event_driven_architecture-----------------"><div class="on go cw oo ed op oq be b bf z bj or">Event Driven Architecture</div></a></div><div class="ol ab"><a class="om ax am ao" rel="noopener follow" href="/tag/google-cloud-platform?source=post_page-----fc8fbbd5f5de---------------google_cloud_platform-----------------"><div class="on go cw oo ed op oq be b bf z bj or">Google Cloud Platform</div></a></div></div></div></div><div class="l"></div><footer class="os ot ou ov ow ox oy oz pa ab q pb gs c"><div class="l ae"><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="ab co pc"><div class="ab q jh"><div class="pd l"><span class="l pe pf pg e d"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div></span><span class="l h g f ph pi"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div></span></div><div class="bp ab"><div><div class="bl" aria-hidden="false"><button class="ao jl kd ke ab q kf kg kh" aria-label="responses"><svg width="24" height="24" viewBox="0 0 24 24" class="ki"><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></button></div></div></div></div><div class="ab q"><div class="pj l hh"></div><div class="pj l hh"><div class="bl" aria-hidden="false" aria-describedby="postFooterSocialMenu" aria-labelledby="postFooterSocialMenu"><div><div class="bl" aria-hidden="false"><button aria-controls="postFooterSocialMenu" aria-expanded="false" aria-label="Share Post" data-testid="footerSocialShareButton" class="af kf ah ai aj ak al kk an ao ap he kl km kh kn"><svg width="24" height="24" viewBox="0 0 24 24" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.22 4.93a.42.42 0 0 1-.12.13h.01a.45.45 0 0 1-.29.08.52.52 0 0 1-.3-.13L12.5 3v7.07a.5.5 0 0 1-.5.5.5.5 0 0 1-.5-.5V3.02l-2 2a.45.45 0 0 1-.57.04h-.02a.4.4 0 0 1-.16-.3.4.4 0 0 1 .1-.32l2.8-2.8a.5.5 0 0 1 .7 0l2.8 2.8a.42.42 0 0 1 .07.5zm-.1.14zm.88 2h1.5a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-11a2 2 0 0 1-2-2v-10a2 2 0 0 1 2-2H8a.5.5 0 0 1 .35.14c.1.1.15.22.15.35a.5.5 0 0 1-.15.35.5.5 0 0 1-.35.15H6.4c-.5 0-.9.4-.9.9v10.2a.9.9 0 0 0 .9.9h11.2c.5 0 .9-.4.9-.9V8.96c0-.5-.4-.9-.9-.9H16a.5.5 0 0 1 0-1z" fill="currentColor"></path></svg></button></div></div></div></div></div></div></div></div></div></footer><div class="pk pl pm pn po l bw"><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="ck ab pp co"><div class="ab gg"><a rel="noopener follow" href="/@sametkaradag?source=post_page-----fc8fbbd5f5de--------------------------------"><div class="l pq pr bx ps gk"><div class="l go"><img alt="Samet Karadag" class="l ec bx pt pu cw" src="https://miro.medium.com/v2/resize:fill:144:144/2*ld3faQ48JO_K1GCBgGfKdg.jpeg" width="72" height="72" loading="lazy"/><div class="gl bx l pt pu eh n gm gn"></div></div></div></a><a href="https://medium.com/google-cloud?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><div class="pv ab go"><div><div class="bl" aria-hidden="false"><div class="l pw px bx ps gs"><div class="l go"><img alt="Google Cloud - Community" class="l ec bx by bz cw" src="https://miro.medium.com/v2/resize:fill:64:64/1*FUjLiCANvATKeaJEeg20Rw.png" width="32" height="32" loading="lazy"/><div class="gl bx l by bz eh n gm gn"></div></div></div></div></div></div></a></div><div class="j i d"><div class="ab"><span><button class="be b bf z py on pz qa qb qc qd qe qf qg qh qi qj qk ql qm ec bl qn of">Follow</button></span><div class="qo l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce198c7d4708&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de&amp;newsletterV3=9e3062ccc5be&amp;newsletterV3Id=ce198c7d4708&amp;user=Samet+Karadag&amp;userId=9e3062ccc5be&amp;source=-----fc8fbbd5f5de---------------------subscribe_user-----------"><button class="be b bf z qq am qr qs qt qu qv qw qx qy qf qg qh qi qj ql qm ec bl qn of" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qp px pw"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="ab cm co"><div class="l"><div class="ab q"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab q" rel="noopener follow" href="/@sametkaradag?source=post_page-----fc8fbbd5f5de--------------------------------"><h2 class="pw-author-name be qz ra rb rc bj"><span class="eo">Written by <!-- -->Samet Karadag</span></h2></a></div><div class="ol ab"><div class="l hh"><span class="pw-follower-count be b bf z bj"><a class="af ag ah ai aj ak al am an ao ap aq ar gy" rel="noopener follow" href="/@sametkaradag/followers?source=post_page-----fc8fbbd5f5de--------------------------------">174 Followers</a></span></div><div class="be b bf z hp hq hr ab ht hu hv hw hb hn"><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span class="l hh">Writer for </span><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b bf z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="rd l"><p class="be b bf z bj"><span class="eo">Strategic Cloud Engineer @ Google Cloud</span></p></div></div><div class="h k"><div class="ab"><span><button class="be b bf z py on pz qa qb qc qd qe qf qg qh qi qj qk ql qm ec bl qn of">Follow</button></span><div class="qo l"><div><div><div class="bl" aria-hidden="false"><div class="l"><span><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/m/signin?actionUrl=%2F_%2Fapi%2Fsubscriptions%2Fnewsletters%2Fce198c7d4708&amp;operation=register&amp;redirect=https%3A%2F%2Fmedium.com%2Fgoogle-cloud%2Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de&amp;newsletterV3=9e3062ccc5be&amp;newsletterV3Id=ce198c7d4708&amp;user=Samet+Karadag&amp;userId=9e3062ccc5be&amp;source=-----fc8fbbd5f5de---------------------subscribe_user-----------"><button class="be b bf z qq am qr qs qt qu qv qw qx qy qf qg qh qi qj ql qm ec bl qn of" aria-label="Subscribe"><svg width="38" height="38" viewBox="0 0 38 38" fill="none" class="qp px pw"><rect x="26.25" y="9.25" width="0.5" height="6.5" rx="0.25"></rect><rect x="29.75" y="12.25" width="0.5" height="6.5" rx="0.25" transform="rotate(90 29.75 12.25)"></rect><path d="M19.5 12.5h-7a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1v-5"></path><path d="M11.5 14.5L19 20l4-3"></path></svg></button></a></span></div></div></div></div></div></div></div></div><div class="re bg rf rg rh ri rj rk"></div></div></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="rv rw l"><h2 class="be qz gw z eu bj">More from <!-- -->Samet Karadag<!-- --> and Google Cloud - Community</h2></div><div class="rx ab jh hk ry rz sa sb sc sd se sf sg sh si sj sk sl sm"><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="How to Calculate Technical Indicators in BigQuery using SQL — Moving Averages, RSI, MACD" rel="noopener follow" href="/google-cloud/how-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="ud ue uf ug uh"><img alt="How to Calculate Technical Indicators in BigQuery using SQL — Moving Averages, RSI, MACD" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*H4jI3ZbUiOKZMjcmJ9ctkw.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@sametkaradag?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="l go"><img alt="Samet Karadag" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/2*ld3faQ48JO_K1GCBgGfKdg.jpeg" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@sametkaradag?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Samet Karadag</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/how-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div title="How to Calculate Technical Indicators in BigQuery using SQL — Moving Averages, RSI, MACD"><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">How to Calculate Technical Indicators in BigQuery using SQL — Moving Averages, RSI, MACD</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Technical indicators are essential tools used by traders and analysts to gain insights into price trends, momentum, and potential reversal…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/how-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e?source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><span class="be b kc z hb"><div class="ab q"><span>4 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Jul 26</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/google-cloud/how-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fc8fbbd5f5de----0---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b kc z hb"><span class="pw-responses-count wo ki">1</span></p></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Generative AI - Document Retrieval and Question Answering with LLMs" rel="noopener follow" href="/google-cloud/generative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="ud ue uf ug uh"><img alt="Generative AI - Document Retrieval and Question Answering with LLMs" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*EeU9ajmZp5LNeJg0xCHueQ.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@saschaheyer?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="l go"><img alt="Sascha Heyer" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/1*0OH3M299jiP0PVYNOJq12A.png" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@saschaheyer?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Sascha Heyer</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/generative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Generative AI - Document Retrieval and Question Answering with LLMs</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Apply LLMs to your domain-specific data</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/generative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d?source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><span class="be b kc z hb"><div class="ab q"><div class="pa ab"><div class="bl" aria-hidden="false"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false"><svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>7 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Jun 5</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/google-cloud/generative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fc8fbbd5f5de----1---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b kc z hb"><span class="pw-responses-count wo ki">10</span></p></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="𝐊𝐮𝐛𝐞𝐫𝐧𝐞𝐭𝐞𝐬 1.28 Some Exciting Features" rel="noopener follow" href="/google-cloud/1-28-some-exciting-features-8407f49cec8c?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="ud ue uf ug uh"><img alt="𝐊𝐮𝐛𝐞𝐫𝐧𝐞𝐭𝐞𝐬 1.28 Some Exciting Features" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*kjt4GjFREVyNCluJHTxiNw.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@harsh.manvar111?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="l go"><img alt="Harsh Manvar" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/1*abC4W3casqS2qVPaH-qcdw.png" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@harsh.manvar111?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Harsh Manvar</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/1-28-some-exciting-features-8407f49cec8c?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">𝐊𝐮𝐛𝐞𝐫𝐧𝐞𝐭𝐞𝐬 1.28 Some Exciting Features</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Quick walkthrough around K8s 1.28 release changes</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/1-28-some-exciting-features-8407f49cec8c?source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><span class="be b kc z hb"><div class="ab q"><span>3 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Aug 24</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/google-cloud/1-28-some-exciting-features-8407f49cec8c?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fc8fbbd5f5de----2---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b kc z hb"><span class="pw-responses-count wo ki">4</span></p></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="How to de-duplicate rows in a BigQuery table" rel="noopener follow" href="/google-cloud/how-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="ud ue uf ug uh"><img alt="How to de-duplicate rows in a BigQuery table" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*yuVzMhCJyDENbyhwAsrkwA.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@sametkaradag?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div class="l go"><img alt="Samet Karadag" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/2*ld3faQ48JO_K1GCBgGfKdg.jpeg" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@sametkaradag?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Samet Karadag</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/how-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">How to de-duplicate rows in a BigQuery table</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Duplicate data sometimes can cause wrong aggregates or results in joins. You probably need to remove those duplicate rows before doing any…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/how-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626?source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><span class="be b kc z hb"><div class="ab q"><span>2 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Nov 19, 2020</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/google-cloud/how-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=author_recirc-----fc8fbbd5f5de----3---------------------07e8d8c8_2c3c_475f_bd66_1464466301d7-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg><p class="be b kc z hb"><span class="pw-responses-count wo ki">6</span></p></a></div></div></div></div><div class="ab q wp wq"></div></div></div></div></div></div></div></div></article></div></div></div><div class="re bg rf dj dk ws wt wu"></div><div class="ab hi hj wv ww wx"><a class="be b bf z bj on wy wz xa xb kg qd qe qf he xc xd xe qj xf xg xh xi xj ql qm ec bl qn of" rel="noopener follow" href="/@sametkaradag?source=post_page-----fc8fbbd5f5de--------------------------------"><div class="l of">See all from <!-- -->Samet Karadag</div></a><div class="xk xl xm xn xo xp xq xr xs kb l"><a class="be b bf z bj on wy wz xa xb kg qd qe qf he xc xd xe qj xf xg xh xi xj ql qm ec bl qn of" href="https://medium.com/google-cloud?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><div class="l of">See all from <!-- -->Google Cloud - Community</div></a></div></div></div></div><div class="re bg rf xt xu xv xw xx"></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="xy xz l"><h2 class="be qz md mf mg mh mj mk ml mn mo mp mr ms mt mv mw bj">Recommended from Medium</h2><div class="ne nf ng nh ni l"><div class="rx ab jh hk ry rz sa sb sc sd se sf sg sh si sj sk sl sm"><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Creating BigQuery Table Snapshots Dynamically" rel="noopener follow" href="/google-cloud/creating-bigquery-table-snapshots-dynamically-c3d14ccd368a?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="Creating BigQuery Table Snapshots Dynamically" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*wsQBK77r0IbXla8qk5Xo3A.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@sahaabhik9?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Abhik Saha" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/1*CYjuHq4Bi3XJqfDtvTzCww.jpeg" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@sahaabhik9?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Abhik Saha</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/google-cloud?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Google Cloud - Community</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/creating-bigquery-table-snapshots-dynamically-c3d14ccd368a?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Creating BigQuery Table Snapshots Dynamically</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">A table snapshot in BigQuery is a way of preserving the contents of a table, referred to as the base table, at a specific moment in time…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/google-cloud/creating-bigquery-table-snapshots-dynamically-c3d14ccd368a?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><span>5 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Apr 27</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/google-cloud/creating-bigquery-table-snapshots-dynamically-c3d14ccd368a?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="What is Google Cloud Bigquery ?" rel="noopener follow" href="/@ludovic-emo/what-is-google-cloud-bigquery-8602b0bd484f?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="What is Google Cloud Bigquery ?" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*xp0id4EQVwXDSuQcfjrbIw.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@ludovic-emo?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Ludovic Emo" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/2*RDs5arNjMRrp25oGCFJl4w.jpeg" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@ludovic-emo?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Ludovic Emo</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@ludovic-emo/what-is-google-cloud-bigquery-8602b0bd484f?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">What is Google Cloud Bigquery ?</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">So many features</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@ludovic-emo/what-is-google-cloud-bigquery-8602b0bd484f?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><span>4 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Sep 24</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/@ludovic-emo/what-is-google-cloud-bigquery-8602b0bd484f?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div></div></div></div></div></div></article></div></div></div></div><div class="re bg rf ya"></div><h2 class="be qz gw z eu bj">Lists</h2><div class="wr l"><div class="cm ab jh hk ry rz sa sb sc sd se sf sg sh si sj sk sl sm"><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><a class="af ag ah ai aj ak al am an ao ap aq ar as at ab ck cm" rel="noopener follow" href="/@william.dai/list/newreadinglist-d8e941a8265f?source=read_next_recirc-----fc8fbbd5f5de--------------------------------"><div class="yh yi hp ab hh go"><div class="go ui yc bw yd"><div class="ui gi hp l"><img alt="Databricks role-based and specialty certification line-up." class="" src="https://miro.medium.com/v2/resize:fill:96:96/1*5eWqBgW5YPFY1SXPu8YkZw.jpeg" width="48" height="48" loading="lazy"/></div></div><div class="go ui yc bw ye yf"><div class="ui gi hp l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:96:96/0*zcJa6-vVfQ1ESpQh.png" width="48" height="48" loading="lazy" role="presentation"/></div></div><div class="go ui bw gs yg"><div class="ui gi hp l"><img alt="" class="" src="https://miro.medium.com/v2/resize:fill:96:96/1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg" width="48" height="48" loading="lazy" role="presentation"/></div></div></div><div class="aw l"><h2 class="be qz gw z hp vw hr hs vx hu hw eu bj">New_Reading_List</h2><div class="be b kc z hb ab yb">174 stories<span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span>149<!-- --> <!-- -->saves</div></div></a></div></div></div><div class="re bg rf xl dj xn dk yj yk yl ym yn yo"></div><div class="rx ab jh hk ry rz sa sb sc sd se sf sg sh si sj sk sl sm"><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Serverless Data Pipelines in GCP using Dataform and BigQuery Remote Functions" rel="noopener follow" href="/engineering-at-premise/serverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="Serverless Data Pipelines in GCP using Dataform and BigQuery Remote Functions" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/0*cSfINV5gIm4zLBx9" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@austennovis?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Austen Novis" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/0*dZCJg1--IGxa3XxB." width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@austennovis?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Austen Novis</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/engineering-at-premise?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Engineering at Premise</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/engineering-at-premise/serverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title="Serverless Data Pipelines in GCP using Dataform and BigQuery Remote Functions"><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Serverless Data Pipelines in GCP using Dataform and BigQuery Remote Functions</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Dataform is an amazing new offering from Google Cloud Platform (GCP) that allows for serverless orchestration for data pipelines…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/engineering-at-premise/serverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18?source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><span>5 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Aug 23</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/engineering-at-premise/serverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----0---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Install and run the Google BigQuery emulator on a Mac with M1" rel="noopener follow" href="/@data-engineering/install-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="Install and run the Google BigQuery emulator on a Mac with M1" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*yuVzMhCJyDENbyhwAsrkwA.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@data-engineering?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Alex" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/1*Vba4BYP79kdnWb6UDZUmyQ.png" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@data-engineering?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Alex</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@data-engineering/install-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Install and run the Google BigQuery emulator on a Mac with M1</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Googles BigQuery service, a part of Google Cloud Platform, has been a boon for businesses, data analysts, and developers worldwide. Its…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@data-engineering/install-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726?source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><span>2 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>Oct 6</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/@data-engineering/install-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----1---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Call an API within Big Query using UDF — Zero ETL" rel="noopener follow" href="/@suhasthakral/call-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff?source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="Call an API within Big Query using UDF — Zero ETL" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/1*3xOOl6JxJ6y1sIlc07Qnig.png" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@suhasthakral?source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Suhas Thakral" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/0*kwYU_VDayZeCQCEx" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@suhasthakral?source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Suhas Thakral</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@suhasthakral/call-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff?source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Call an API within Big Query using UDF — Zero ETL</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">We are getting in an era where streaming data is getting faster and easier and real time dashboard are getting more and more common. With…</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@suhasthakral/call-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff?source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><span>2 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>May 5</span></div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/@suhasthakral/call-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----2---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div><div class="j i d"><div class="re bg rf wr"></div></div></div></div></div></div></div></article></div></div><div class="sn so sp sq sr ss st su sv sw sx sy sz ta tb tc td te tf tg th"><div class="ti tj tk tl tm tn l"><article class="tn"><div class="tn pa l"><div class="bg tn"><div class="tn l"><div class="tn to tp tq tr ts tt tu tv tw tx ty tz ua"><div class="ub"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" aria-label="Using Dynamic SQL in BigQuery" rel="noopener follow" href="/data-engineers-notes/using-dynamic-sql-in-bigquery-c39f96978b77?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="ud ue uf ug uh"><img alt="Using Dynamic SQL in BigQuery" class="bg ui uj uk ul bw" src="https://miro.medium.com/v2/resize:fit:1358/0*2d57XAfSgYYA6iOr" loading="lazy"/></div></a></div><div class="uc ab ca cn"><div class="um un uo up uq ab"><div class="om l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/@cnstlungu?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div class="l go"><img alt="Constantin Lungu" class="l ec bx us ut cw" src="https://miro.medium.com/v2/resize:fill:40:40/2*lv00-9htqJmN38udEIFXVw.jpeg" width="20" height="20" loading="lazy"/><div class="ur bx l us ut eh n ax gn"></div></div></a></div></div></div><div class="uu l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" rel="noopener follow" href="/@cnstlungu?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Constantin Lungu</p></a></div></div></div><div class="uu l"><p class="be b kc z hb">in</p></div><div class="l"><div><div class="bl" aria-hidden="false"><a class="af ag ah ai aj ak al am an ao ap aq ar gy ab q" href="https://medium.com/data-engineers-notes?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------" rel="noopener follow"><p class="be b kc z hp hq hr hs ht hu hv hw bj">Data Engineer’s Notes</p></a></div></div></div></div><div class="uv uw ux uy uz va vb vc vd ve l eo"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/data-engineers-notes/using-dynamic-sql-in-bigquery-c39f96978b77?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><div title=""><h2 class="be ew md mf vf vg mg mh mj vh vi mk ln vj vk vl vm lr vn vo vp vq lv vr vs vt vu hp hr hs hu hw bj">Using Dynamic SQL in BigQuery</h2></div><div class="vv l"><h3 class="be b gw z hp vw hr hs vx hu hw hb">Today I want to spotlight an interesting tool, present in multiple database systems, including BigQuery — Dynamic SQL.</h3></div></a></div><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/data-engineers-notes/using-dynamic-sql-in-bigquery-c39f96978b77?source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><span class="be b kc z hb"><div class="ab q"><div class="pa ab"><div class="bl" aria-hidden="false"><button class="l ax ao am" aria-label="Member-only story"><div class=""><div><div class="bl" aria-hidden="false"><svg width="16" height="16" viewBox="0 0 20 20" fill="none"><path d="M12.4 12.77l-1.81 4.99a.63.63 0 0 1-1.18 0l-1.8-4.99a.63.63 0 0 0-.38-.37l-4.99-1.81a.62.62 0 0 1 0-1.18l4.99-1.8a.63.63 0 0 0 .37-.38l1.81-4.99a.63.63 0 0 1 1.18 0l1.8 4.99a.63.63 0 0 0 .38.37l4.99 1.81a.63.63 0 0 1 0 1.18l-4.99 1.8a.63.63 0 0 0-.37.38z" fill="#FFC017"></path></svg></div></div></div></button></div></div><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span><span>3 min read</span><span class="gz l" aria-hidden="true"><span class="be b bf z hb">·</span></span>2 days ago</div></span></a><div class="vy vz wa wb wc l"><div class="ab co"><div class="am wd we wf wg wh wi wj wk wl wm ab q"><div class="ab q jh"><div class="pw-multi-vote-icon go ho ji jj jk"><div class=""><div class="jl jm jn jo jp jq jr am js jt ju jk"><svg width="24" height="24" viewBox="0 0 24 24" aria-label="clap"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.37.83L12 3.28l.63-2.45h-1.26zM15.42 1.84l-1.18-.39-.34 2.5 1.52-2.1zM9.76 1.45l-1.19.4 1.53 2.1-.34-2.5zM20.25 11.84l-2.5-4.4a1.42 1.42 0 0 0-.93-.64.96.96 0 0 0-.75.18c-.25.19-.4.42-.45.7l.05.05 2.35 4.13c1.62 2.95 1.1 5.78-1.52 8.4l-.46.41c1-.13 1.93-.6 2.78-1.45 2.7-2.7 2.51-5.59 1.43-7.38zM12.07 9.01c-.13-.69.08-1.3.57-1.77l-2.06-2.07a1.12 1.12 0 0 0-1.56 0c-.15.15-.22.34-.27.53L12.07 9z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M14.74 8.3a1.13 1.13 0 0 0-.73-.5.67.67 0 0 0-.53.13c-.15.12-.59.46-.2 1.3l1.18 2.5a.45.45 0 0 1-.23.76.44.44 0 0 1-.48-.25L7.6 6.11a.82.82 0 1 0-1.15 1.15l3.64 3.64a.45.45 0 1 1-.63.63L5.83 7.9 4.8 6.86a.82.82 0 0 0-1.33.9c.04.1.1.18.18.26l1.02 1.03 3.65 3.64a.44.44 0 0 1-.15.73.44.44 0 0 1-.48-.1L4.05 9.68a.82.82 0 0 0-1.4.57.81.81 0 0 0 .24.58l1.53 1.54 2.3 2.28a.45.45 0 0 1-.64.63L3.8 13a.81.81 0 0 0-1.39.57c0 .22.09.43.24.58l4.4 4.4c2.8 2.8 5.5 4.12 8.68.94 2.27-2.28 2.71-4.6 1.34-7.1l-2.32-4.08z"></path></svg></div></div></div><div class="pw-multi-vote-count l jv jw jx jy jz ka kb"><p class="be b kc z hb"><span class="jm">--</span></p></div></div><div class="wn l"><div><div class="bl" aria-hidden="false"><a class="af kf ah jl aj ak al ke an ao ap aq ar as at kd ab q kg kh" aria-label="responses" rel="noopener follow" href="/data-engineers-notes/using-dynamic-sql-in-bigquery-c39f96978b77?responsesOpen=true&amp;sortBy=REVERSE_CHRON&amp;source=read_next_recirc-----fc8fbbd5f5de----3---------------------0d283857_8960_4010_ad4f_0af621eeff4a-------"><svg width="24" height="24" viewBox="0 0 24 24" class=""><path d="M18 16.8a7.14 7.14 0 0 0 2.24-5.32c0-4.12-3.53-7.48-8.05-7.48C7.67 4 4 7.36 4 11.48c0 4.13 3.67 7.48 8.2 7.48a8.9 8.9 0 0 0 2.38-.32c.23.2.48.39.75.56 1.06.69 2.2 1.04 3.4 1.04.22 0 .4-.11.48-.29a.5.5 0 0 0-.04-.52 6.4 6.4 0 0 1-1.16-2.65v.02zm-3.12 1.06l-.06-.22-.32.1a8 8 0 0 1-2.3.33c-4.03 0-7.3-2.96-7.3-6.59S8.17 4.9 12.2 4.9c4 0 7.1 2.96 7.1 6.6 0 1.8-.6 3.47-2.02 4.72l-.2.16v.26l.02.3a6.74 6.74 0 0 0 .88 2.4 5.27 5.27 0 0 1-2.17-.86c-.28-.17-.72-.38-.94-.59l.01-.02z"></path></svg></a></div></div></div></div><div class="ab q wp wq"></div></div></div></div></div></div></div></div></article></div></div></div><div class="re bg rf dj dk ws wt wu"></div><a class="be b bf z bj on wy wz xa xb kg qd qe qf he xc xd xe qj xf xg xh xi xj ql qm ec bl qn of" rel="noopener follow" href="/?source=post_page-----fc8fbbd5f5de--------------------------------"><div class="l of">See more recommendations</div></a></div></div></div><div class="h k j"><div class="re bg rf rl"></div><div class="ab ca"><div class="ch bg dx dy dz ea"><div class="rm ab jh hk"><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://help.medium.com/hc/en-us?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Help</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.statuspage.io/?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Status</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://medium.com/about?autoplay=1&amp;source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">About</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/jobs-at-medium/work-at-medium-959d1a85284e?source=post_page-----fc8fbbd5f5de--------------------------------"><p class="be b kc z hb">Careers</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://blog.medium.com/?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Blog</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-privacy-policy-f03bf92035c9?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Privacy</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://policy.medium.com/medium-terms-of-service-9db0094a1e0f?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Terms</p></a></div><div class="rn ro l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" href="https://speechify.com/medium?source=post_page-----fc8fbbd5f5de--------------------------------" rel="noopener follow"><p class="be b kc z hb">Text to speech</p></a></div><div class="rn l"><a class="af ag ah ai aj ak al am an ao ap aq ar as at" rel="noopener follow" href="/business?source=post_page-----fc8fbbd5f5de--------------------------------"><p class="be b kc z hb">Teams</p></a></div></div></div></div></div></div></div></div></div></div><script>window.__BUILD_ID__="main-20231013-135801-a585c891ad"</script><script>window.__GRAPHQL_URI__ = "https://medium.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"algolia":{"queries":{}},"cache":{"experimentGroupSet":true,"reason":"","group":"enabled","tags":["group-edgeCachePosts","post-fc8fbbd5f5de","user-9e3062ccc5be","collection-e52cf94d98af"],"serverVariantState":"44136fa355b3678a1146ad16f7e8649e94fb4fc21fe77e8310c060f61caaff8a","middlewareEnabled":true,"cacheStatus":"DYNAMIC","shouldUseCache":true,"vary":[],"inDisabledExperiment":false,"loHomepageEnabled":false},"client":{"hydrated":false,"isUs":false,"isNativeMedium":false,"isSafariMobile":false,"isSafari":false,"isFirefox":false,"routingEntity":{"type":"DEFAULT","explicit":false},"viewerIsBot":false},"debug":{"requestId":"78df8c82-2777-4ee9-a3ce-94a643a2e18f","hybridDevServices":[],"originalSpanCarrier":{"ot-tracer-spanid":"18e387fb427e7ea6","ot-tracer-traceid":"5b6895f4583afbc7","ot-tracer-sampled":"true"}},"multiVote":{"clapsPerPost":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de","host":"medium.com","hostname":"medium.com","referrer":"","hasSetReferrer":false,"susiModal":{"step":null,"operation":"register"},"postRead":false,"queryString":"","currentHash":""},"config":{"nodeEnv":"production","version":"main-20231013-135801-a585c891ad","target":"production","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"applicationId":"6702d87d-a7e0-42fe-bbcb-95b469547ea0","clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","rumToken":"pubf9cc52896502b9413b68ba36fc0c7162","context":{"deployment":{"target":"production","tag":"main-20231013-135801-a585c891ad","commit":"a585c891ad49eb127e278f23d21852a3c5e4f3ea"}},"datacenter":"us"},"googleAnalyticsCode":"G-7JY7T788PK","googlePay":{"apiVersion":"2","apiVersionMinor":"0","merchantId":"BCR2DN6TV7EMTGBM","merchantName":"Medium","instanceMerchantId":"13685562959212738550"},"applePay":{"version":3},"signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumMastodonDomainName":"me.dm","mediumOwnedAndOperatedCollectionIds":["8a9336e5bb4","b7e45b22fec3","193b68bd4fba","8d6b8a439e32","54c98c43354d","3f6ecf56618","d944778ce714","92d2092dc598","ae2a65f35510","1285ba81cada","544c7006046e","fc8964313712","40187e704f1c","88d9857e584e","7b6769f2748b","bcc38c8f6edf","cef6983b292","cb8577c9149e","444d13b52878","713d7dbc99b0","ef8e90590e66","191186aaafa0","55760f21cdc5","9dc80918cc93","bdc4052bbdba","8ccfed20cbb2"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"topicsToFollow":["d61cf867d93f","8a146bc21b28","1eca0103fff3","4d562ee63426","aef1078a3ef5","e15e46793f8d","6158eb913466","55f1c20aba7a","3d18b94f6858","4861fee224fd","63c6f1f93ee","1d98b3a9a871","decb52b64abf","ae5d4995e225","830cded25262"],"topicToTagMappings":{"accessibility":"accessibility","addiction":"addiction","android-development":"android-development","art":"art","artificial-intelligence":"artificial-intelligence","astrology":"astrology","basic-income":"basic-income","beauty":"beauty","biotech":"biotech","blockchain":"blockchain","books":"books","business":"business","cannabis":"cannabis","cities":"cities","climate-change":"climate-change","comics":"comics","coronavirus":"coronavirus","creativity":"creativity","cryptocurrency":"cryptocurrency","culture":"culture","cybersecurity":"cybersecurity","data-science":"data-science","design":"design","digital-life":"digital-life","disability":"disability","economy":"economy","education":"education","equality":"equality","family":"family","feminism":"feminism","fiction":"fiction","film":"film","fitness":"fitness","food":"food","freelancing":"freelancing","future":"future","gadgets":"gadgets","gaming":"gaming","gun-control":"gun-control","health":"health","history":"history","humor":"humor","immigration":"immigration","ios-development":"ios-development","javascript":"javascript","justice":"justice","language":"language","leadership":"leadership","lgbtqia":"lgbtqia","lifestyle":"lifestyle","machine-learning":"machine-learning","makers":"makers","marketing":"marketing","math":"math","media":"media","mental-health":"mental-health","mindfulness":"mindfulness","money":"money","music":"music","neuroscience":"neuroscience","nonfiction":"nonfiction","outdoors":"outdoors","parenting":"parenting","pets":"pets","philosophy":"philosophy","photography":"photography","podcasts":"podcast","poetry":"poetry","politics":"politics","privacy":"privacy","product-management":"product-management","productivity":"productivity","programming":"programming","psychedelics":"psychedelics","psychology":"psychology","race":"race","relationships":"relationships","religion":"religion","remote-work":"remote-work","san-francisco":"san-francisco","science":"science","self":"self","self-driving-cars":"self-driving-cars","sexuality":"sexuality","social-media":"social-media","society":"society","software-engineering":"software-engineering","space":"space","spirituality":"spirituality","sports":"sports","startups":"startup","style":"style","technology":"technology","transportation":"transportation","travel":"travel","true-crime":"true-crime","tv":"tv","ux":"ux","venture-capital":"venture-capital","visual-design":"visual-design","work":"work","world":"world","writing":"writing"},"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*kFrc4tBFM_tCis-2Ic87WA.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":[],"COVID_APPLICABLE_TOPIC_NAMES":[],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":[],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"unbound":{"text":"This article is free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":45,"end":59,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":127,"end":134,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"sharedVoteMessaging":{"TAGS":["politics","election-2020","government","us-politics","election","2020-presidential-race","trump","donald-trump","democrats","republicans","congress","republican-party","democratic-party","biden","joe-biden","maga"],"TOPICS":["politics","election"],"MESSAGE":{"text":"Find out more about the U.S. election results here.","markups":[{"start":46,"end":50,"href":"https:\u002F\u002Fcookpolitical.com\u002F2020-national-popular-vote-tracker"}]},"EXCLUDE_POSTS":["397ef29e3ca5"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4","braintree":{"enabled":true,"merchantId":"m56f8fqpf7ngnrd4","merchantAccountId":{"usd":"AMediumCorporation_instant","eur":"amediumcorporation_EUR","cad":"amediumcorporation_CAD"},"publicKey":"ds2nn34bg2z7j5gd","braintreeEnvironment":"production","dashboardUrl":"https:\u002F\u002Fwww.braintreegateway.com\u002Fmerchants","gracePeriodDurationInDays":14,"mediumMembershipPlanId":{"monthly":"ce105f8c57a3","monthlyWithTrial":"d5ee3dbe3db8","monthlyPremium":"fa741a9b47a2","yearly":"a40ad4a43185","yearlyStaff":"d74fb811198a","yearlyWithTrial":"b3bc7350e5c7","yearlyPremium":"e21bd2c12166","monthlyCad":"p52orjkaceei","yearlyCad":"h4q9g2up9ktt"},"braintreeDiscountId":{"oneMonthFree":"MONTHS_FREE_01","threeMonthsFree":"MONTHS_FREE_03","sixMonthsFree":"MONTHS_FREE_06","fiftyPercentOffOneYear":"FIFTY_PERCENT_OFF_ONE_YEAR"},"3DSecureVersion":"2","defaultCurrency":"usd","providerPlanIdCurrency":{"4ycw":"usd","rz3b":"usd","3kqm":"usd","jzw6":"usd","c2q2":"usd","nnsw":"usd","q8qw":"usd","d9y6":"usd","fx7w":"cad","nwf2":"cad"}},"paypalClientId":"AXj1G4fotC2GE8KzWX9mSxCH1wmPE3nJglf4Z2ig_amnhvlMVX87otaq58niAg9iuLktVNF_1WCMnN7v","paypal":{"host":"https:\u002F\u002Fapi.paypal.com:443","clientMode":"production","serverMode":"live","webhookId":"4G466076A0294510S","monthlyPlan":{"planId":"P-9WR0658853113943TMU5FDQA","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlan":{"planId":"P-7N8963881P8875835MU5JOPQ","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oneYearGift":{"name":"Medium Membership (1 Year, Digital Gift Code)","description":"Unlimited access to the best and brightest stories on Medium. Gift codes can be redeemed at medium.com\u002Fredeem.","price":"50.00","currency":"USD","sku":"membership-gift-1-yr"},"oldMonthlyPlan":{"planId":"P-96U02458LM656772MJZUVH2Y","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlan":{"planId":"P-59P80963JF186412JJZU3SMI","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"monthlyPlanWithTrial":{"planId":"P-66C21969LR178604GJPVKUKY","name":"Medium Membership (Monthly) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"yearlyPlanWithTrial":{"planId":"P-6XW32684EX226940VKCT2MFA","name":"Medium Membership (Annual) with setup fee","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"oldMonthlyPlanNoSetupFee":{"planId":"P-4N046520HR188054PCJC7LJI","name":"Medium Membership (Monthly)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed monthly."},"oldYearlyPlanNoSetupFee":{"planId":"P-7A4913502Y5181304CJEJMXQ","name":"Medium Membership (Annual)","description":"Unlimited access to the best and brightest stories on Medium. Membership billed annually."},"sdkUrl":"https:\u002F\u002Fwww.paypal.com\u002Fsdk\u002Fjs"},"stripePublishableKey":"pk_live_7FReX44VnNIInZwrIIx6ghjl","log":{"json":true,"level":"info"},"imageUploadMaxSizeMb":25,"staffPicks":{"title":"Staff Picks","catalogId":"c7bc6e1ee00f"}},"session":{"xsrf":""}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY":{"__typename":"Query","isLoggedIn":false,"collectionByDomainOrSlug({\"domainOrSlug\":\"google-cloud\"})":{"__ref":"Collection:e52cf94d98af"},"postResult({\"id\":\"fc8fbbd5f5de\"})":{"__ref":"Post:fc8fbbd5f5de"},"post({\"id\":\"fc8fbbd5f5de\"})":{"__ref":"Post:fc8fbbd5f5de"},"authorCollectionRecircFeed({\"input\":{\"authorId\":\"9e3062ccc5be\",\"collectionId\":\"e52cf94d98af\",\"paging\":{\"limit\":4},\"postId\":\"fc8fbbd5f5de\"}})":{"__typename":"AuthorCollectionRecircFeedResult","items":[{"__typename":"HomeFeedItem","post":{"__ref":"Post:b58b16e4f52e"},"feedId":"07e8d8c8-2c3c-475f-bd66-1464466301d7"},{"__typename":"HomeFeedItem","post":{"__ref":"Post:2b0fb80ae76d"},"feedId":"07e8d8c8-2c3c-475f-bd66-1464466301d7"},{"__typename":"HomeFeedItem","post":{"__ref":"Post:8407f49cec8c"},"feedId":"07e8d8c8-2c3c-475f-bd66-1464466301d7"},{"__typename":"HomeFeedItem","post":{"__ref":"Post:55f7d6321626"},"feedId":"07e8d8c8-2c3c-475f-bd66-1464466301d7"}]},"recirc({\"paging\":{\"limit\":6},\"postId\":\"fc8fbbd5f5de\"})":{"__typename":"RexRecircResult","items":[{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:c3d14ccd368a"}},{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:8602b0bd484f"}},{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:9ee235d0cb18"}},{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:c11cf826d726"}},{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:e17ecb258aff"}},{"__typename":"RexRecircItem","feedId":"0d283857-8960-4010-ad4f-0af621eeff4a","post":{"__ref":"Post:c39f96978b77"}}]},"postCatalogRecirc({\"pagingOptions\":{\"limit\":4},\"postId\":\"fc8fbbd5f5de\"})":{"__typename":"CatalogsConnection","catalogs":[{"__ref":"Catalog:d8e941a8265f"}]}},"ImageMetadata:":{"__typename":"ImageMetadata","id":"","focusPercentX":null,"focusPercentY":null,"alt":null},"Collection:e52cf94d98af":{"__typename":"Collection","id":"e52cf94d98af","favicon":{"__ref":"ImageMetadata:"},"customStyleSheet":null,"colorPalette":{"__typename":"ColorPalette","highlightSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FFFFFFFF","point":0},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.1},{"__typename":"ColorPoint","color":"#FFE8F3E8","point":0.2},{"__typename":"ColorPoint","color":"#FFD1E7D1","point":0.6},{"__typename":"ColorPoint","color":"#FFA3D0A2","point":1}]},"defaultBackgroundSpectrum":{"__typename":"ColorSpectrum","backgroundColor":"#FFFFFFFF","colorPoints":[{"__typename":"ColorPoint","color":"#FF1A8917","point":0},{"__typename":"ColorPoint","color":"#FF11800E","point":0.1},{"__typename":"ColorPoint","color":"#FF0F730C","point":0.2},{"__typename":"ColorPoint","color":"#FF095407","point":1}]},"tintBackgroundSpectrum":null},"googleAnalyticsId":null,"editors":[{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:57387f5314d0"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4b21e207ea2c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ba5e3c69c42b"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:d2cb9c480c2"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:a605188ce9a2"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6444b44155fa"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4671bccf7793"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:b78c1a5c6205"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:fd5b0ab116"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:3c8940cc93e2"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:dc8042aba528"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:87b2115d4438"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:6be63961431c"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:247b0630b5d6"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:1edffb4bff44"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:ee41cca2a1f8"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:9b9e67983b04"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:696b1d0329cc"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:5d492117810d"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:340ea4574481"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:15ff4e21c33"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:dbfb8e06b9f2"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:4eb6c1562d42"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:802a4d428d95"}},{"__typename":"CollectionMastheadUserItem","user":{"__ref":"User:86600de286f3"}}],"name":"Google Cloud - Community","avatar":{"__ref":"ImageMetadata:1*FUjLiCANvATKeaJEeg20Rw.png"},"domain":null,"slug":"google-cloud","description":"A collection of technical articles and blogs published or curated by Google Cloud Developer Advocates. The views expressed are those of the authors and don't necessarily reflect those of Google.","subscriberCount":53355,"viewerEdge":{"__ref":"CollectionViewerEdge:collectionId:e52cf94d98af-viewerId:lo_87fdc59358fb"},"twitterUsername":"googlecloudtech","facebookPageId":null,"logo":{"__ref":"ImageMetadata:1*FUjLiCANvATKeaJEeg20Rw.png"}},"User:57387f5314d0":{"__typename":"User","id":"57387f5314d0"},"User:4b21e207ea2c":{"__typename":"User","id":"4b21e207ea2c"},"User:ba5e3c69c42b":{"__typename":"User","id":"ba5e3c69c42b"},"User:d2cb9c480c2":{"__typename":"User","id":"d2cb9c480c2"},"User:a605188ce9a2":{"__typename":"User","id":"a605188ce9a2"},"User:6444b44155fa":{"__typename":"User","id":"6444b44155fa"},"User:4671bccf7793":{"__typename":"User","id":"4671bccf7793"},"User:b78c1a5c6205":{"__typename":"User","id":"b78c1a5c6205"},"User:fd5b0ab116":{"__typename":"User","id":"fd5b0ab116"},"User:3c8940cc93e2":{"__typename":"User","id":"3c8940cc93e2"},"User:dc8042aba528":{"__typename":"User","id":"dc8042aba528"},"User:87b2115d4438":{"__typename":"User","id":"87b2115d4438"},"User:6be63961431c":{"__typename":"User","id":"6be63961431c"},"User:247b0630b5d6":{"__typename":"User","id":"247b0630b5d6"},"User:1edffb4bff44":{"__typename":"User","id":"1edffb4bff44"},"User:ee41cca2a1f8":{"__typename":"User","id":"ee41cca2a1f8"},"User:9b9e67983b04":{"__typename":"User","id":"9b9e67983b04"},"User:696b1d0329cc":{"__typename":"User","id":"696b1d0329cc"},"User:5d492117810d":{"__typename":"User","id":"5d492117810d"},"User:340ea4574481":{"__typename":"User","id":"340ea4574481"},"User:15ff4e21c33":{"__typename":"User","id":"15ff4e21c33"},"User:dbfb8e06b9f2":{"__typename":"User","id":"dbfb8e06b9f2"},"User:4eb6c1562d42":{"__typename":"User","id":"4eb6c1562d42"},"User:802a4d428d95":{"__typename":"User","id":"802a4d428d95"},"User:86600de286f3":{"__typename":"User","id":"86600de286f3"},"ImageMetadata:1*FUjLiCANvATKeaJEeg20Rw.png":{"__typename":"ImageMetadata","id":"1*FUjLiCANvATKeaJEeg20Rw.png","originalWidth":192,"originalHeight":192},"LinkedAccounts:9e3062ccc5be":{"__typename":"LinkedAccounts","mastodon":null,"id":"9e3062ccc5be"},"UserViewerEdge:userId:9e3062ccc5be-viewerId:lo_87fdc59358fb":{"__typename":"UserViewerEdge","id":"userId:9e3062ccc5be-viewerId:lo_87fdc59358fb","isFollowing":false,"isUser":false},"NewsletterV3:ce198c7d4708":{"__typename":"NewsletterV3","id":"ce198c7d4708","type":"NEWSLETTER_TYPE_AUTHOR","slug":"9e3062ccc5be","name":"9e3062ccc5be","collection":null,"user":{"__ref":"User:9e3062ccc5be"}},"User:9e3062ccc5be":{"__typename":"User","id":"9e3062ccc5be","name":"Samet Karadag","username":"sametkaradag","newsletterV3":{"__ref":"NewsletterV3:ce198c7d4708"},"linkedAccounts":{"__ref":"LinkedAccounts:9e3062ccc5be"},"isSuspended":false,"imageId":"2*ld3faQ48JO_K1GCBgGfKdg.jpeg","mediumMemberAt":0,"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"socialStats":{"__typename":"SocialStats","followerCount":174},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"sametkaradag.medium.com"}},"hasSubdomain":true,"bio":"Strategic Cloud Engineer @ Google Cloud","isPartnerProgramEnrolled":false,"viewerEdge":{"__ref":"UserViewerEdge:userId:9e3062ccc5be-viewerId:lo_87fdc59358fb"},"viewerIsUser":false,"postSubscribeMembershipUpsellShownAt":0,"allowNotes":true,"membership":null,"twitterScreenName":"samkaradag"},"Paragraph:40a72c27eb22_0":{"__typename":"Paragraph","id":"40a72c27eb22_0","name":"214d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_1":{"__typename":"Paragraph","id":"40a72c27eb22_1","name":"81b7","type":"P","href":null,"layout":null,"metadata":null,"text":"In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and curates it based on where it came from. We’ll use Cloud Workflows triggered by GCS events and Cloud Functions to do this.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_2":{"__typename":"Paragraph","id":"40a72c27eb22_2","name":"1729","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 1: Create a Cloud Function to load data from GCS to BigQuery","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_3":{"__typename":"Paragraph","id":"40a72c27eb22_3","name":"a8c8","type":"P","href":null,"layout":null,"metadata":null,"text":"In my previous post I wrote about how to streamline data ingestion with event-driven serverless loads into BigQuery from GCS using Cloud Functions triggered by new uploads.","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":6,"end":19,"href":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fstreamline-your-data-ingestion-with-event-driven-loads-into-bigquery-from-gcs-using-cloud-functions-e1e2e3d376bf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_4":{"__typename":"Paragraph","id":"40a72c27eb22_4","name":"d0ab","type":"P","href":null,"layout":null,"metadata":null,"text":"We will use the same function with some changes to trigger it via Workflows rather than GCS.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_5":{"__typename":"Paragraph","id":"40a72c27eb22_5","name":"cff6","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is the updated cloud function that is triggered via pubsub and workflows (please read my previous post for more details on this function):","hasDropCap":null,"dropCapImage":null,"markups":[{"__typename":"Markup","type":"A","start":91,"end":107,"href":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fstreamline-your-data-ingestion-with-event-driven-loads-into-bigquery-from-gcs-using-cloud-functions-e1e2e3d376bf","anchorType":"LINK","userId":null,"linkMetadata":null}],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_6":{"__typename":"Paragraph","id":"40a72c27eb22_6","name":"a90b","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import os\nimport json\nfrom google.cloud import bigquery\nfrom google.cloud import storage\nimport functions_framework\nimport time\nimport datetime\nfrom flask import jsonify\n\n# Set your GCS bucket and BigQuery dataset and table names\nBIGQUERY_DATASET_ID = 'ingestion'\n\ndef prepare_json_file(file_bucket, file_name):\n    # Initialize GCS client\n    storage_client = storage.Client()\n    temp_file_name = '.\u002F'+file_bucket+'_'+file_name \n\n    # Download the file from GCS to a local temporary file\n    bucket = storage_client.bucket(file_bucket)\n    blob = bucket.blob(file_name)\n    blob.download_to_filename(temp_file_name)\n\n    # Read the content of the temporary file\n    with open(temp_file_name, 'r') as file:\n    #     lines = file.readlines()\n        json_file = json.load(file)\n\n    records = [json.dumps(record) for record in json_file[\"records\"]] \n\n    newline_delimited_json = '\\n'.join(records)\n\n    # Check if the file has at least 2 lines\n    if len(newline_delimited_json) \u003E= 2:\n\n        # # Write the modified content to a new temporary file\n        with open(temp_file_name, 'w') as file:\n            file.writelines(newline_delimited_json)\n\n        # Upload the modified file to GCS, to the process_json bucket\n        bucket = storage_client.bucket('preprocess_json')\n        blob = bucket.blob(file_name)\n        blob.upload_from_filename(temp_file_name)\n        print(f\"Converted '{file_name}' to newline_delimited_json format in GCS bucket '{file_bucket}'.\")\n\n    else:\n        print(\"The file does not have enough lines to remove the first and last lines.\")\n\n    # Clean up the local temporary file\n    os.remove(temp_file_name)\n    return file_name\n\n\ndef get_table_schema(table_id):\n    # Initialize BigQuery client\n    bigquery_client = bigquery.Client()\n\n    # Get the schema of the existing table\n    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(table_id)\n    table = bigquery_client.get_table(table_ref)\n\n    return table.schema\n\ndef create_empty_table(table_id, schema):\n    # Initialize BigQuery client\n    bigquery_client = bigquery.Client()\n\n    # Construct the BigQuery table reference\n    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(table_id)\n\n    # Define the schema for the new table\n    table = bigquery.Table(table_ref, schema=schema)\n\n    # set table to expire 5 days from now\n    expiration = datetime.datetime.now(datetime.timezone.utc) + datetime.timedelta(\n        days=1\n    )\n\n    table.expires = expiration\n\n    # Create the empty table in BigQuery\n    bigquery_client.create_table(table)\n\n    print(f\"Empty table {table_id} created in BigQuery.\")\n\ndef load_data_to_bigquery(data):\n    # Get the file details from the event\n    file_name = data['objectId']\n    file_bucket = data['bucketId']\n\n    BIGQUERY_TABLE_ID = file_bucket.split('-')[1].upper()\n    # Create a new table name with a timestamp epoch\n    epoch_timestamp = str(int(time.time()*1000000))\n    new_table_name = f\"{BIGQUERY_TABLE_ID}_{epoch_timestamp}\"\n\n    # Initialize BigQuery and Storage clients\n    bigquery_client = bigquery.Client()\n    storage_client = storage.Client()\n\n    # Construct the BigQuery table reference\n    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(BIGQUERY_TABLE_ID)\n\n    # Get the schema from an existing table (e.g., ingestion.DP1)\n    schema = bigquery_client.get_table(table_ref).schema  # Change to the desired table\n\n    # Construct the BigQuery table reference\n    table_ref = bigquery_client.dataset(BIGQUERY_DATASET_ID).table(new_table_name)\n\n    # Create a new empty table with the same schema as the existing table\n    create_empty_table(new_table_name, schema)\n\n    # Define job configuration\n    job_config = bigquery.LoadJobConfig(\n        autodetect=True,\n        source_format=bigquery.SourceFormat.CSV if file_name.endswith('.csv') else bigquery.SourceFormat.NEWLINE_DELIMITED_JSON,\n        write_disposition=bigquery.WriteDisposition.WRITE_TRUNCATE,\n    )\n\n    # If it is a JSON file remove first and last line to convert it to newline_delimited_json rather than an array\n    if file_name.endswith('.json'):\n        file_name = prepare_json_file(file_bucket, file_name)\n        file_bucket = 'preprocess_json'\n\n    # Load data from GCS to BigQuery\n    uri = f\"gs:\u002F\u002F{file_bucket}\u002F{file_name}\"\n    load_job = bigquery_client.load_table_from_uri(uri, table_ref, job_config=job_config)\n\n    load_job.result()  # Wait for the job to complete\n\n    print(f\"File {file_name} loaded into BigQuery table {BIGQUERY_DATASET_ID}.{new_table_name}\")\n    return new_table_name\n\n# Entry point for Cloud Function\n# Triggered by pubsub\n@functions_framework.http\ndef main(request):\n    # data = request.data.message.attributes\n    print(request)\n    request_json = request.get_json(silent=True)\n    request_args = request.args\n    print(request_json)\n\n    if request_json and 'input' in request_json:\n        data = request_json['input']['data']['message']['attributes']\n            \n        bucket = data[\"bucketId\"]\n        name = data[\"objectId\"]\n        timeCreated = data[\"eventTime\"]\n    else:\n        raise ValueError(\"JSON is invalid, or missing a 'data' property\")\n\n    \n    print(f\"Data: {data}\")\n\n    print(f\"Bucket: {bucket}\")\n    print(f\"File: {name}\")\n    print(f\"Created: {timeCreated}\")\n\n    return_msg = load_data_to_bigquery(data)\n\n    return jsonify({ 'table_name' :  return_msg })\n","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_7":{"__typename":"Paragraph","id":"40a72c27eb22_7","name":"47c3","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 2: Create a Cloud Function to curate the data","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_8":{"__typename":"Paragraph","id":"40a72c27eb22_8","name":"677d","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is a sample Cloud Function which transforms data from the staging table to the curated table based on its type which is embedded in the table_name;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_9":{"__typename":"Paragraph","id":"40a72c27eb22_9","name":"22b9","type":"PRE","href":null,"layout":null,"metadata":null,"text":"import os\nfrom google.cloud import bigquery\nfrom google.cloud import storage\nimport functions_framework\n\n\n# Initialize the BigQuery client\nbq_client = bigquery.Client()\n\n@functions_framework.http\ndef curate(request):\n    request_json = request.get_json(silent=True)\n    request_args = request.args\n    print(request_json)\n\n    if request_json and 'input' in request_json:\n        table_name = request_json['input']['body']['table_name']\n    else:\n        raise ValueError(\"JSON is invalid, or missing a 'table_name' property\")\n\n\n\n    # Define the SQL queries for DP1 and DP2\n    t1_query = f\"\"\"\n    INSERT INTO curated.common_target (\n        \u003Ccolumn_list\u003E\n    )\n    SELECT\n        \u003Ccolumn_list with required mappings\u003E\n    FROM ingestion.{table_name} T\n    JOIN `project_id.curated.lookup` c on (t.lookupcol1 = c.C1 or t.lookupcol1 = c.C2)\n    \"\"\" \n\n    t2_query = f\"\"\"\n    INSERT INTO curated.common_target (\n        \u003Ccolumn_list\u003E\n    )\n    SELECT\n       \u003Ccolumn_list with required mappings\u003E\n    FROM ingestion.{table_name} t\n    JOIN `project_id.curated.lookup` c on (t.lookupcol1 = c.C1 or t.lookupcol1 = c.C2)\n    \"\"\"\n\n    # Determine which query to execute based on the table name suffix\n    data_type = table_name.split(\"_\")[0]\n    if data_type == 'T1':\n        query = t1_query\n    elif data_type == 'T2':\n        query = t2_query\n    else:\n        raise ValueError(f\"Unsupported table name: {table_name}\")\n\n    # Execute the SQL query\n    job_config = bigquery.QueryJobConfig()\n    query_job = bq_client.query(query, job_config=job_config)\n\n    # Wait for the query job to complete\n    query_job.result()\n\n    print(f\"Curated data for input data type {data_type}\")\n    return (f\"Curated data for input data type {data_type}\")\n","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"python"},"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_10":{"__typename":"Paragraph","id":"40a72c27eb22_10","name":"20f8","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 3: Create a workflow to trigger the Cloud Functions","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_11":{"__typename":"Paragraph","id":"40a72c27eb22_11","name":"47bd","type":"P","href":null,"layout":null,"metadata":null,"text":"Here is a sample workflow which is triggered by Eventarc pubsub message and runs load and curate functions per file.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*MbjpDYnhlwdiTkkNQcq2wA.png":{"__typename":"ImageMetadata","id":"1*MbjpDYnhlwdiTkkNQcq2wA.png","originalHeight":972,"originalWidth":462,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:40a72c27eb22_12":{"__typename":"Paragraph","id":"40a72c27eb22_12","name":"dd81","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*MbjpDYnhlwdiTkkNQcq2wA.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_13":{"__typename":"Paragraph","id":"40a72c27eb22_13","name":"24a4","type":"P","href":null,"layout":null,"metadata":null,"text":"1. Goto Workflows page in GCP and Click the “Create Workflow” button.\n2. Enter a name for the workflow, such as `gcs_to_bq_load_curate`.\n3. Click the ‘Add trigger’ button.\n4. Select the ‘Eventarc’ trigger.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*oRu5axmyLy7g9Vfq8XYJWQ.png":{"__typename":"ImageMetadata","id":"1*oRu5axmyLy7g9Vfq8XYJWQ.png","originalHeight":376,"originalWidth":436,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:40a72c27eb22_14":{"__typename":"Paragraph","id":"40a72c27eb22_14","name":"0b1b","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*oRu5axmyLy7g9Vfq8XYJWQ.png"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"ImageMetadata:1*AOk32OrgMsYRodL7cc3IEg.png":{"__typename":"ImageMetadata","id":"1*AOk32OrgMsYRodL7cc3IEg.png","originalHeight":808,"originalWidth":880,"focusPercentX":null,"focusPercentY":null,"alt":null},"Paragraph:40a72c27eb22_15":{"__typename":"Paragraph","id":"40a72c27eb22_15","name":"45b1","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"__ref":"ImageMetadata:1*AOk32OrgMsYRodL7cc3IEg.png"},"text":"Eventarc Trigger","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_16":{"__typename":"Paragraph","id":"40a72c27eb22_16","name":"4243","type":"P","href":null,"layout":null,"metadata":null,"text":"5- Provide YAML configuration on the next page.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_17":{"__typename":"Paragraph","id":"40a72c27eb22_17","name":"3bad","type":"P","href":null,"layout":null,"metadata":null,"text":"Workflow YAML:","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_18":{"__typename":"Paragraph","id":"40a72c27eb22_18","name":"ba86","type":"PRE","href":null,"layout":null,"metadata":null,"text":"main:\n  params: [event]\n  steps:\n    - logStep:\n        call: sys.log\n        args:\n            text: ${event}\n            severity: INFO\n    - gcs_to_bq_load:\n        call: http.post\n        args:\n            url: https:\u002F\u002Fus-central1-project-id.cloudfunctions.net\u002Fgcs_to_bq \n            body:\n                input: ${event}\n            auth:\n              type: OIDC\n        result: gcs_to_bq_result\n        next: curate_common\n\n\n    - curate_common: \n        call: http.post\n        args:\n            url: https:\u002F\u002Fus-central1-project-id.cloudfunctions.net\u002Fcurate-to-common\n            body:\n                input: ${gcs_to_bq_result}\n            auth:\n              type: OIDC\n        result: curate_result","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"yaml"},"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_19":{"__typename":"Paragraph","id":"40a72c27eb22_19","name":"c5c7","type":"H3","href":null,"layout":null,"metadata":null,"text":"Step 4: Create GCS Event Triggers","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_20":{"__typename":"Paragraph","id":"40a72c27eb22_20","name":"9734","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we have our Cloud Workflow is ready and listening to pubsub messages. Final piece that we need is to create GCS event trigger to publish a message whenever a file is uploaded.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_21":{"__typename":"Paragraph","id":"40a72c27eb22_21","name":"747d","type":"P","href":null,"layout":null,"metadata":null,"text":"You can do it in Cloud Shell or your terminal with the following cmd;","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_22":{"__typename":"Paragraph","id":"40a72c27eb22_22","name":"cd4e","type":"PRE","href":null,"layout":null,"metadata":null,"text":"#Add notification for the first source bucket\ngcloud storage buckets notifications create --event-types=OBJECT_FINALIZE gs:\u002F\u002Finput-bucket1 --topic projects\u002Fproject-id\u002Ftopics\u002Fgcs_upload_event_trigger\n\n#If you want to listen multiple buckets add notifications for those buckets as well\ngcloud storage buckets notifications create --event-types=OBJECT_FINALIZE gs:\u002F\u002Finput-bucket2 --topic projects\u002Fproject-id\u002Ftopics\u002Fgcs_upload_event_trigger","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":{"__typename":"CodeBlockMetadata","mode":"AUTO","lang":"bash"},"iframe":null,"mixtapeMetadata":null},"Paragraph:40a72c27eb22_23":{"__typename":"Paragraph","id":"40a72c27eb22_23","name":"d355","type":"P","href":null,"layout":null,"metadata":null,"text":"Now we have the copmplete event-driven serverless data pipeline to automatically load from gcs to bq and curate. Please let me know what you think or if you have any questions.","hasDropCap":null,"dropCapImage":null,"markups":[],"codeBlockMetadata":null,"iframe":null,"mixtapeMetadata":null},"CollectionViewerEdge:collectionId:e52cf94d98af-viewerId:lo_87fdc59358fb":{"__typename":"CollectionViewerEdge","id":"collectionId:e52cf94d98af-viewerId:lo_87fdc59358fb","isEditor":false},"Tag:bigquery":{"__typename":"Tag","id":"bigquery","displayTitle":"Bigquery","normalizedTagSlug":"bigquery"},"Tag:gcp-workflows":{"__typename":"Tag","id":"gcp-workflows","displayTitle":"Gcp Workflows","normalizedTagSlug":"gcp-workflows"},"Tag:cloud-functions":{"__typename":"Tag","id":"cloud-functions","displayTitle":"Cloud Functions","normalizedTagSlug":"cloud-functions"},"Tag:event-driven-architecture":{"__typename":"Tag","id":"event-driven-architecture","displayTitle":"Event Driven Architecture","normalizedTagSlug":"event-driven-architecture"},"Tag:google-cloud-platform":{"__typename":"Tag","id":"google-cloud-platform","displayTitle":"Google Cloud Platform","normalizedTagSlug":"google-cloud-platform"},"Post:fc8fbbd5f5de":{"__typename":"Post","id":"fc8fbbd5f5de","collection":{"__ref":"Collection:e52cf94d98af"},"content({\"postMeteringOptions\":{}})":{"__typename":"PostContent","isLockedPreviewOnly":false,"bodyModel":{"__typename":"RichText","sections":[{"__typename":"Section","name":"e2cc","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null}],"paragraphs":[{"__ref":"Paragraph:40a72c27eb22_0"},{"__ref":"Paragraph:40a72c27eb22_1"},{"__ref":"Paragraph:40a72c27eb22_2"},{"__ref":"Paragraph:40a72c27eb22_3"},{"__ref":"Paragraph:40a72c27eb22_4"},{"__ref":"Paragraph:40a72c27eb22_5"},{"__ref":"Paragraph:40a72c27eb22_6"},{"__ref":"Paragraph:40a72c27eb22_7"},{"__ref":"Paragraph:40a72c27eb22_8"},{"__ref":"Paragraph:40a72c27eb22_9"},{"__ref":"Paragraph:40a72c27eb22_10"},{"__ref":"Paragraph:40a72c27eb22_11"},{"__ref":"Paragraph:40a72c27eb22_12"},{"__ref":"Paragraph:40a72c27eb22_13"},{"__ref":"Paragraph:40a72c27eb22_14"},{"__ref":"Paragraph:40a72c27eb22_15"},{"__ref":"Paragraph:40a72c27eb22_16"},{"__ref":"Paragraph:40a72c27eb22_17"},{"__ref":"Paragraph:40a72c27eb22_18"},{"__ref":"Paragraph:40a72c27eb22_19"},{"__ref":"Paragraph:40a72c27eb22_20"},{"__ref":"Paragraph:40a72c27eb22_21"},{"__ref":"Paragraph:40a72c27eb22_22"},{"__ref":"Paragraph:40a72c27eb22_23"}]},"validatedShareKey":"","shareKeyCreator":null},"creator":{"__ref":"User:9e3062ccc5be"},"inResponseToEntityType":null,"isLocked":false,"isMarkedPaywallOnly":false,"lockedSource":"LOCKED_POST_SOURCE_NONE","mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fbuilding-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de","primaryTopic":null,"topics":[{"__typename":"Topic","slug":"programming"}],"isPublished":true,"latestPublishedVersion":"40a72c27eb22","visibility":"PUBLIC","postResponses":{"__typename":"PostResponses","count":0},"createdAt":1697191563483,"firstPublishedAt":1697193411286,"latestPublishedAt":1697196587564,"clapCount":2,"allowResponses":true,"isLimitedState":false,"title":"Building an Event-Driven Serverless Data Pipeline with Google Cloud Workflows and Functions","isSeries":false,"sequence":null,"uniqueSlug":"building-an-event-driven-serverless-data-pipeline-with-google-cloud-workflows-and-functions-fc8fbbd5f5de","socialTitle":"","socialDek":"","noIndex":null,"canonicalUrl":"","metaDescription":"","readingTime":4.833018867924528,"previewContent":{"__typename":"PreviewContent","subtitle":"In this blog post, we’ll explain how to create an event driven system that loads data from Google Cloud Storage (GCS) to BigQuery and…"},"previewImage":{"__ref":"ImageMetadata:1*MbjpDYnhlwdiTkkNQcq2wA.png"},"isShortform":false,"seoTitle":"","updatedAt":1697269040272,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false,"license":"ALL_RIGHTS_RESERVED","tags":[{"__ref":"Tag:bigquery"},{"__ref":"Tag:gcp-workflows"},{"__ref":"Tag:cloud-functions"},{"__ref":"Tag:event-driven-architecture"},{"__ref":"Tag:google-cloud-platform"}],"pendingCollection":null,"statusForCollection":"APPROVED","layerCake":0,"detectedLanguage":"en","wordCount":1135,"inResponseToPostResult":null,"inResponseToCatalogResult":null,"curationEligibleAt":0,"isNewsletter":false,"isPublishToEmail":true},"ImageMetadata:1*H4jI3ZbUiOKZMjcmJ9ctkw.png":{"__typename":"ImageMetadata","id":"1*H4jI3ZbUiOKZMjcmJ9ctkw.png","focusPercentX":null,"focusPercentY":null,"alt":null},"Post:b58b16e4f52e":{"__typename":"Post","id":"b58b16e4f52e","title":"How to Calculate Technical Indicators in BigQuery using SQL — Moving Averages, RSI, MACD","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Technical indicators are essential tools used by traders and analysts to gain insights into price trends, momentum, and potential reversal…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*H4jI3ZbUiOKZMjcmJ9ctkw.png"},"creator":{"__ref":"User:9e3062ccc5be"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fhow-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e","collection":{"__ref":"Collection:e52cf94d98af"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":1},"visibility":"PUBLIC","clapCount":12,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1690433366139,"firstPublishedAt":1690370450539,"readingTime":3.9735849056603776,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"how-to-calculate-technical-indicators-in-bigquery-using-sql-moving-averages-rsi-macd-b58b16e4f52e"},"ImageMetadata:1*EeU9ajmZp5LNeJg0xCHueQ.png":{"__typename":"ImageMetadata","id":"1*EeU9ajmZp5LNeJg0xCHueQ.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:57d0091b2e22":{"__typename":"User","id":"57d0091b2e22","name":"Sascha Heyer","username":"saschaheyer","mediumMemberAt":1609421196000,"socialStats":{"__typename":"SocialStats","followerCount":1350},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"saschaheyer.medium.com"}},"hasSubdomain":true,"bio":"Hi, I am Sascha, Senior Machine Learning Engineer at @DoiT. Support me by becoming a Medium member 🙏 bit.ly\u002Fsascha-support","imageId":"1*0OH3M299jiP0PVYNOJq12A.png","membership":{"__ref":"Membership:8e54412ad849"}},"Membership:8e54412ad849":{"__typename":"Membership","tier":"MEMBER","id":"8e54412ad849"},"Post:2b0fb80ae76d":{"__typename":"Post","id":"2b0fb80ae76d","title":"Generative AI - Document Retrieval and Question Answering with LLMs","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Apply LLMs to your domain-specific data","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*EeU9ajmZp5LNeJg0xCHueQ.png"},"creator":{"__ref":"User:57d0091b2e22"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fgenerative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d","collection":{"__ref":"Collection:e52cf94d98af"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":10},"visibility":"LOCKED","clapCount":316,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1696106510014,"firstPublishedAt":1685926912038,"readingTime":6.939622641509434,"isLocked":true,"sequence":null,"isSeries":false,"uniqueSlug":"generative-ai-document-retrieval-and-question-answering-with-llms-2b0fb80ae76d"},"ImageMetadata:1*kjt4GjFREVyNCluJHTxiNw.png":{"__typename":"ImageMetadata","id":"1*kjt4GjFREVyNCluJHTxiNw.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:292ba81a5690":{"__typename":"User","id":"292ba81a5690","name":"Harsh Manvar","username":"harsh.manvar111","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":615},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Engineer @ Oracle, Docker Captain, Don’t hesitate to contact on : https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fharsh-manvar-64a30aa3\u002F","imageId":"1*abC4W3casqS2qVPaH-qcdw.png","membership":null},"Post:8407f49cec8c":{"__typename":"Post","id":"8407f49cec8c","title":"𝐊𝐮𝐛𝐞𝐫𝐧𝐞𝐭𝐞𝐬 1.28 Some Exciting Features","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Quick walkthrough around K8s 1.28 release changes","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*kjt4GjFREVyNCluJHTxiNw.png"},"creator":{"__ref":"User:292ba81a5690"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002F1-28-some-exciting-features-8407f49cec8c","collection":{"__ref":"Collection:e52cf94d98af"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":4},"visibility":"PUBLIC","clapCount":126,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1692939283293,"firstPublishedAt":1692901717184,"readingTime":2.667924528301887,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"1-28-some-exciting-features-8407f49cec8c"},"Post:55f7d6321626":{"__typename":"Post","id":"55f7d6321626","title":"How to de-duplicate rows in a BigQuery table","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Duplicate data sometimes can cause wrong aggregates or results in joins. You probably need to remove those duplicate rows before doing any…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:"},"creator":{"__ref":"User:9e3062ccc5be"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fhow-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626","collection":{"__ref":"Collection:e52cf94d98af"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":6},"visibility":"PUBLIC","clapCount":62,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1664954970500,"firstPublishedAt":1605796081311,"readingTime":1.4933962264150944,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"how-to-de-duplicate-rows-in-a-bigquery-table-55f7d6321626"},"ImageMetadata:1*wsQBK77r0IbXla8qk5Xo3A.png":{"__typename":"ImageMetadata","id":"1*wsQBK77r0IbXla8qk5Xo3A.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:e2bc6105615":{"__typename":"User","id":"e2bc6105615","name":"Abhik Saha","username":"sahaabhik9","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":81},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Data Engineer @Accenture India || Writes about Bigquery, Cloud Function, GCP, SQL || LinkedIn ID: https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fabhik-saha-919646108\u002F","imageId":"1*CYjuHq4Bi3XJqfDtvTzCww.jpeg","membership":null},"Post:c3d14ccd368a":{"__typename":"Post","id":"c3d14ccd368a","title":"Creating BigQuery Table Snapshots Dynamically","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"A table snapshot in BigQuery is a way of preserving the contents of a table, referred to as the base table, at a specific moment in time…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*wsQBK77r0IbXla8qk5Xo3A.png"},"creator":{"__ref":"User:e2bc6105615"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fgoogle-cloud\u002Fcreating-bigquery-table-snapshots-dynamically-c3d14ccd368a","collection":{"__ref":"Collection:e52cf94d98af"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":21,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1696124308843,"firstPublishedAt":1682590640433,"readingTime":4.791509433962264,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"creating-bigquery-table-snapshots-dynamically-c3d14ccd368a"},"ImageMetadata:1*xp0id4EQVwXDSuQcfjrbIw.png":{"__typename":"ImageMetadata","id":"1*xp0id4EQVwXDSuQcfjrbIw.png","focusPercentX":null,"focusPercentY":null,"alt":""},"User:c6aa5990c7c9":{"__typename":"User","id":"c6aa5990c7c9","name":"Ludovic Emo","username":"ludovic-emo","mediumMemberAt":1697204940000,"socialStats":{"__typename":"SocialStats","followerCount":31},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"ludovic-emo.medium.com"}},"hasSubdomain":true,"bio":"","imageId":"2*RDs5arNjMRrp25oGCFJl4w.jpeg","membership":{"__ref":"Membership:97fb568c1327"}},"Membership:97fb568c1327":{"__typename":"Membership","tier":"MEMBER","id":"97fb568c1327"},"Post:8602b0bd484f":{"__typename":"Post","id":"8602b0bd484f","title":"What is Google Cloud Bigquery ?","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"So many features","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*xp0id4EQVwXDSuQcfjrbIw.png"},"creator":{"__ref":"User:c6aa5990c7c9"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fludovic-emo.medium.com\u002Fwhat-is-google-cloud-bigquery-8602b0bd484f","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":2,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1696827673268,"firstPublishedAt":1695589903655,"readingTime":3.009748427672956,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"what-is-google-cloud-bigquery-8602b0bd484f"},"ImageMetadata:0*cSfINV5gIm4zLBx9":{"__typename":"ImageMetadata","id":"0*cSfINV5gIm4zLBx9","focusPercentX":null,"focusPercentY":null,"alt":null},"User:8b06b96dee6c":{"__typename":"User","id":"8b06b96dee6c","name":"Austen Novis","username":"austennovis","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":186},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":{"__typename":"CustomDomainState","live":{"__typename":"CustomDomain","domain":"austennovis.medium.com"}},"hasSubdomain":true,"bio":"Software Engineer at Premise","imageId":"0*dZCJg1--IGxa3XxB.","membership":null},"Collection:c5fada0a103d":{"__typename":"Collection","id":"c5fada0a103d","slug":"engineering-at-premise","name":"Engineering at Premise","domain":"engineering.premise.com","description":"Premise engineers close the information gap in a complex, evolving world. We empower millions around the globe to collect and share information with decision makers, providing them with Data for Every Decision™","subscriberCount":74,"avatar":{"__ref":"ImageMetadata:1*WG258G-7TUcAi1otYInrdA.jpeg"}},"ImageMetadata:1*WG258G-7TUcAi1otYInrdA.jpeg":{"__typename":"ImageMetadata","id":"1*WG258G-7TUcAi1otYInrdA.jpeg"},"Post:9ee235d0cb18":{"__typename":"Post","id":"9ee235d0cb18","title":"Serverless Data Pipelines in GCP using Dataform and BigQuery Remote Functions","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Dataform is an amazing new offering from Google Cloud Platform (GCP) that allows for serverless orchestration for data pipelines…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:0*cSfINV5gIm4zLBx9"},"creator":{"__ref":"User:8b06b96dee6c"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fengineering.premise.com\u002Fserverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18","collection":{"__ref":"Collection:c5fada0a103d"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":13,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1692797722715,"firstPublishedAt":1692797722715,"readingTime":4.85377358490566,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"serverless-data-pipelines-in-gcp-using-dataform-and-bigquery-remote-functions-9ee235d0cb18"},"User:aa8b46d6b1c3":{"__typename":"User","id":"aa8b46d6b1c3","name":"Alex","username":"data-engineering","mediumMemberAt":1629482090000,"socialStats":{"__typename":"SocialStats","followerCount":4},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"","imageId":"1*Vba4BYP79kdnWb6UDZUmyQ.png","membership":{"__ref":"Membership:9e169a45f8d1"}},"Membership:9e169a45f8d1":{"__typename":"Membership","tier":"MEMBER","id":"9e169a45f8d1"},"Post:c11cf826d726":{"__typename":"Post","id":"c11cf826d726","title":"Install and run the Google BigQuery emulator on a Mac with M1","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Googles BigQuery service, a part of Google Cloud Platform, has been a boon for businesses, data analysts, and developers worldwide. Its…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:"},"creator":{"__ref":"User:aa8b46d6b1c3"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@data-engineering\u002Finstall-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":6,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1696601604237,"firstPublishedAt":1696601138026,"readingTime":1.4867924528301886,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"install-and-run-the-google-bigquery-emulator-on-a-mac-with-m1-c11cf826d726"},"ImageMetadata:1*3xOOl6JxJ6y1sIlc07Qnig.png":{"__typename":"ImageMetadata","id":"1*3xOOl6JxJ6y1sIlc07Qnig.png","focusPercentX":null,"focusPercentY":null,"alt":null},"User:46c0dab15e75":{"__typename":"User","id":"46c0dab15e75","name":"Suhas Thakral","username":"suhasthakral","mediumMemberAt":0,"socialStats":{"__typename":"SocialStats","followerCount":346},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"https:\u002F\u002Fwww.linkedin.com\u002Fin\u002Fsuhas-thakral Working in the field of business intelligence and trying to answer questions which I could not find on Google!!","imageId":"0*kwYU_VDayZeCQCEx","membership":null},"Post:e17ecb258aff":{"__typename":"Post","id":"e17ecb258aff","title":"Call an API within Big Query using UDF — Zero ETL","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"We are getting in an era where streaming data is getting faster and easier and real time dashboard are getting more and more common. With…","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:1*3xOOl6JxJ6y1sIlc07Qnig.png"},"creator":{"__ref":"User:46c0dab15e75"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002F@suhasthakral\u002Fcall-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff","collection":null,"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"PUBLIC","clapCount":17,"pendingCollection":null,"statusForCollection":null,"pinnedAt":0,"latestPublishedAt":1697021576018,"firstPublishedAt":1683298958129,"readingTime":1.9962264150943396,"isLocked":false,"sequence":null,"isSeries":false,"uniqueSlug":"call-an-api-within-big-query-using-udf-zero-etl-e17ecb258aff"},"ImageMetadata:0*2d57XAfSgYYA6iOr":{"__typename":"ImageMetadata","id":"0*2d57XAfSgYYA6iOr","focusPercentX":null,"focusPercentY":null,"alt":null},"User:4d9c0f2c17a0":{"__typename":"User","id":"4d9c0f2c17a0","name":"Constantin Lungu","username":"cnstlungu","mediumMemberAt":1694117469000,"socialStats":{"__typename":"SocialStats","followerCount":200},"verifications":{"__typename":"VerifiedInfo","isBookAuthor":false},"customDomainState":null,"hasSubdomain":false,"bio":"Software Engineer with a focus on Analytics — Data Engineering, Data Science & Business Intelligence | Opinions are my own","imageId":"2*lv00-9htqJmN38udEIFXVw.jpeg","membership":{"__ref":"Membership:f1a3c08c289"}},"Collection:9122cc53ad61":{"__typename":"Collection","id":"9122cc53ad61","slug":"data-engineers-notes","name":"Data Engineer’s Notes","domain":null,"description":"Travel log of a Data Engineer. Navigating contemporary Data Analytics step-by-step. Mastering through practice.","subscriberCount":12,"avatar":{"__ref":"ImageMetadata:1*vsXNEgMooKAnzKpGSX4IIA.png"}},"Membership:f1a3c08c289":{"__typename":"Membership","tier":"MEMBER","id":"f1a3c08c289"},"ImageMetadata:1*vsXNEgMooKAnzKpGSX4IIA.png":{"__typename":"ImageMetadata","id":"1*vsXNEgMooKAnzKpGSX4IIA.png"},"Post:c39f96978b77":{"__typename":"Post","id":"c39f96978b77","title":"Using Dynamic SQL in BigQuery","extendedPreviewContent":{"__typename":"PreviewContent","subtitle":"Today I want to spotlight an interesting tool, present in multiple database systems, including BigQuery — Dynamic SQL.","isFullContent":false},"previewImage":{"__ref":"ImageMetadata:0*2d57XAfSgYYA6iOr"},"creator":{"__ref":"User:4d9c0f2c17a0"},"isPublished":true,"mediumUrl":"https:\u002F\u002Fmedium.com\u002Fdata-engineers-notes\u002Fusing-dynamic-sql-in-bigquery-c39f96978b77","collection":{"__ref":"Collection:9122cc53ad61"},"isLimitedState":false,"allowResponses":true,"postResponses":{"__typename":"PostResponses","count":0},"visibility":"LOCKED","clapCount":22,"pendingCollection":null,"statusForCollection":"APPROVED","pinnedAt":0,"latestPublishedAt":1697033879441,"firstPublishedAt":1697033879441,"readingTime":2.2518867924528303,"isLocked":true,"sequence":null,"isSeries":false,"uniqueSlug":"using-dynamic-sql-in-bigquery-c39f96978b77"},"User:cd694379bdff":{"__typename":"User","username":"william.dai","id":"cd694379bdff","customDomainState":null,"hasSubdomain":false},"CatalogViewerEdge:catalogId:d8e941a8265f-viewerId:lo_87fdc59358fb":{"__typename":"CatalogViewerEdge","followersCount":149,"id":"catalogId:d8e941a8265f-viewerId:lo_87fdc59358fb"},"ImageMetadata:1*5eWqBgW5YPFY1SXPu8YkZw.jpeg":{"__typename":"ImageMetadata","id":"1*5eWqBgW5YPFY1SXPu8YkZw.jpeg","alt":"Databricks role-based and specialty certification line-up."},"Post:a55f84478c66":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*5eWqBgW5YPFY1SXPu8YkZw.jpeg"},"id":"a55f84478c66"},"CatalogItemV2:{\"catalogItemId\":\"64aa0d844b220edd4bf735cb\"}":{"__typename":"CatalogItemV2","catalogItemId":"64aa0d844b220edd4bf735cb","entity":{"__ref":"Post:a55f84478c66"}},"ImageMetadata:0*zcJa6-vVfQ1ESpQh.png":{"__typename":"ImageMetadata","id":"0*zcJa6-vVfQ1ESpQh.png","alt":null},"Post:9a325b2f1b17":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*zcJa6-vVfQ1ESpQh.png"},"id":"9a325b2f1b17"},"CatalogItemV2:{\"catalogItemId\":\"640c272f665be4da892df879\"}":{"__typename":"CatalogItemV2","catalogItemId":"640c272f665be4da892df879","entity":{"__ref":"Post:9a325b2f1b17"}},"ImageMetadata:1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg":{"__typename":"ImageMetadata","id":"1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg","alt":null},"Post:255c5de9f67d":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*Cw-ig4gq9DXIqEXANhNvqQ.jpeg"},"id":"255c5de9f67d"},"CatalogItemV2:{\"catalogItemId\":\"63fc775f35ac6e382f606006\"}":{"__typename":"CatalogItemV2","catalogItemId":"63fc775f35ac6e382f606006","entity":{"__ref":"Post:255c5de9f67d"}},"ImageMetadata:0*H92fOk6xK_oDEIkT":{"__typename":"ImageMetadata","id":"0*H92fOk6xK_oDEIkT","alt":null},"Post:c445b6c0712d":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:0*H92fOk6xK_oDEIkT"},"id":"c445b6c0712d"},"CatalogItemV2:{\"catalogItemId\":\"63eb589f651cc18fd371e228\"}":{"__typename":"CatalogItemV2","catalogItemId":"63eb589f651cc18fd371e228","entity":{"__ref":"Post:c445b6c0712d"}},"ImageMetadata:1*sYHiUkJdawisp4LSYh-5vQ.jpeg":{"__typename":"ImageMetadata","id":"1*sYHiUkJdawisp4LSYh-5vQ.jpeg","alt":null},"Post:f787b185aa57":{"__typename":"Post","previewImage":{"__ref":"ImageMetadata:1*sYHiUkJdawisp4LSYh-5vQ.jpeg"},"id":"f787b185aa57"},"CatalogItemV2:{\"catalogItemId\":\"63eb28ddf0060edddb8da34b\"}":{"__typename":"CatalogItemV2","catalogItemId":"63eb28ddf0060edddb8da34b","entity":{"__ref":"Post:f787b185aa57"}},"Catalog:d8e941a8265f":{"__typename":"Catalog","id":"d8e941a8265f","name":"New_Reading_List","postItemsCount":174,"predefined":null,"creator":{"__ref":"User:cd694379bdff"},"viewerEdge":{"__ref":"CatalogViewerEdge:catalogId:d8e941a8265f-viewerId:lo_87fdc59358fb"},"itemsConnection:(limit:5)":{"__typename":"CatalogItemsConnection","items":[{"__ref":"CatalogItemV2:{\"catalogItemId\":\"64aa0d844b220edd4bf735cb\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"640c272f665be4da892df879\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63fc775f35ac6e382f606006\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63eb589f651cc18fd371e228\"}"},{"__ref":"CatalogItemV2:{\"catalogItemId\":\"63eb28ddf0060edddb8da34b\"}"}]}}}</script><script>window.__MIDDLEWARE_STATE__={"session":{"xsrf":""},"cache":{"cacheStatus":"HIT","inDisabledExperiment":false}}</script><script src="https://cdn-client.medium.com/lite/static/js/manifest.3580fb83.js"></script><script src="https://cdn-client.medium.com/lite/static/js/1008.9e2c8ae5.js"></script><script src="https://cdn-client.medium.com/lite/static/js/main.1e07fd7e.js"></script><script src="https://cdn-client.medium.com/lite/static/js/instrumentation.7cdafcd5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/reporting.2021fe63.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6068.466148a0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3130.d84e5554.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6733.c6c17f3e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4711.eb865124.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8695.4a6127a5.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4341.39719d69.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/3154.8be4a205.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5203.972fb599.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1957.6de9754c.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9599.0edb614e.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1711.6127e5e0.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5268.340f7f3b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9114.0acbd6c8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5459.cfc2e69b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6804.2f4a4354.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9174.ca12091f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4129.5e8e8e93.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8580.2dd0c5ae.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1802.266129dd.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2295.dfe54a2b.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4078.9fb8a750.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/8883.b0b4b29f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/6885.a7ee4568.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9408.2907bde4.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1743.8ee80896.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/4667.5c0c8d6f.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/9150.e244f1b8.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/5005.4ccc91b2.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/2804.9c761555.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/1006.97cfd7bf.chunk.js"></script>
<script src="https://cdn-client.medium.com/lite/static/js/PostPage.MainContent.a45afdbb.chunk.js"></script><script>window.main();</script><script defer src="https://static.cloudflareinsights.com/beacon.min.js/v8b253dfea2ab4077af8c6f58422dfbfd1689876627854" integrity="sha512-bjgnUKX4azu3dLTVtie9u6TKqgx29RBwfj3QXYt5EKfWM/9hPSAI/4qcV5NACjwAo8UtTeWefx6Zq5PHcMm7Tg==" data-cf-beacon='{"rayId":"81659b54bad38871","version":"2023.8.0","b":1,"token":"0b5f665943484354a59c39c6833f7078","si":100}' crossorigin="anonymous"></script>
</body></html>